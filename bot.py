import os
import json
import asyncio
import aiohttp
import logging
from datetime import datetime
import random
import time

# Configuration
TELEGRAM_BOT_TOKEN = os.environ.get('TELEGRAM_BOT_TOKEN', '')
TELEGRAM_CHAT_ID = os.environ.get('TELEGRAM_CHAT_ID', '')
STEAM_API_KEY = os.environ.get('STEAM_API_KEY', '')


STEAM_ACCOUNTS = [

    


'76561199060130027','76561199059999621','76561199060035763','76561199060172727','76561199058542575','76561199386777816',
'76561199088800488','76561199057622808','76561199057986506','76561199057266622','76561199060290922','76561199057076420',
'76561199057104815','76561199057181378','76561199059995283','76561199059943329','76561199060176073','76561199060137919',
'76561199060246754','76561199057561572','76561199059920411','76561199059056674','76561199060018655','76561199057409183',
'76561199057435029','76561199057049916','76561199057127458','76561199059961339','76561199058574821','76561199049982938',
'76561199059914026','76561199060014618','76561199057266709','76561199057041631','76561199050119287','76561199060138661',
'76561199059922909','76561199057115135','76561199058327621','76561199057242337','76561199059016468','76561199056998390',
'76561199060069489','76561199059976864','76561199057206486','76561199057181389','76561199057256227','76561199060317482',
'76561199059349556','76561199033169865','76561199057212998','76561199088891604','76561199088904454','76561199075318018',
'76561199214507804','76561199098725168','76561199089092594','76561198996004514','76561199438101379','76561199060000590',
'76561199376388792','76561199442427823','76561199375665922','76561199376274556','76561199376107896','76561199444412250',
'76561199376334679','76561199376367793','76561199438487858','76561199370861538','76561199371430818','76561199442058567',
'76561199375957403','76561199452743310','76561199392624500','76561199444784660','76561199442512187','76561199439351307',
'76561199438972526','76561199443034235','76561199444406963','76561199375949504','76561199376158766','76561199435152466',
'76561199439172781','76561199376320906','76561199437233519','76561199452546525','76561199371131768','76561199452650095',
'76561199385672399','76561199437824628','76561199375848583','76561199441524184','76561199434843478','76561199375930562',
'76561199376095399','76561199376139192','76561199438786164','76561199434333643','76561199438884900','76561199392291585',
'76561199439489194','76561199376226098','76561199376163234','76561199439409711','76561198005480248','76561198006499599',
'76561198007710946',
'76561198008601457','76561198009963972','76561198010396485','76561198011055148','76561198011283714','76561198011415472',
'76561198011939695','76561198013052096','76561198013052359','76561198014779286','76561198015385952','76561198016713891',
'76561198017647480','76561198018771636','76561199389846086','76561199445826678','76561199465288921','76561199566449480',
'76561199566735144','76561199567480752','76561199567812624','76561199571342371','76561199571623668','76561199765240515',
'76561199776736055','76561199776980101','76561199777390958','76561199777769130','76561199017818176','76561198004931462',
'76561198004990892','76561198005233225','76561198005498101','76561198005801377','76561198006570954','76561198008304860',
'76561198008699141','76561198009971796','76561198010044001','76561198012721027','76561198014013605','76561198014021046',
'76561198014750212','76561198015770989','76561198016662032','76561198018134936','76561199405036477','76561199466800120',
'76561199521048872','76561199545877895','76561199549240693','76561199567170958','76561199567771202','76561199567839849',
'76561199571521873','76561199571537374','76561199765028730','76561199765162914','76561199765614149','76561199765709801',
'76561199776305355','76561199777012094','76561199777264721','76561199777309764','76561199777488416','76561198004759511',
'76561198006466295','76561198007158152','76561198007517384','76561198012457984','76561198013661557','76561198014788092',
'76561198015452772','76561198015642475','76561198017894555','76561198018653994','76561198018784440','76561199347489743',
'76561199392428830','76561199404527810','76561199446571689','76561199446760127','76561199466895778','76561199549719239',
'76561199566427443','76561199568349883','76561199568546097','76561199570636268','76561199766348314','76561199775917225',
'76561199776547969','76561199777306781','76561199778215452','76561199813042763','76561199102963119','76561198288680041',
'76561198994562590','76561198007560351','76561198010653949','76561198011480009','76561198011596777','76561198011930524',
'76561198013069949','76561198016256444','76561198016484516','76561198017057629','76561199311281063','76561199428853987',
'76561199429728493','76561199446070710','76561199447124304','76561199447368169','76561199465898716','76561199466392007',
'76561199466506046','76561199466529707','76561199467466683','76561199527661020','76561199533768270','76561199542064176',
'76561199549842771','76561199567621740','76561199570918787','76561199764712135','76561199775656341','76561199776283347',
'76561199776788869','76561199777454106','76561199777476515','76561199777640984','76561199777978725','76561199813936885',
'76561198005576129','76561198006472505','76561198006923371','76561198007390762','76561198008688826','76561198009140434',
'76561198010472789','76561198010656004','76561198011333080','76561198014108817','76561198015412264','76561198016908054',
'76561198017112672','76561199421954300','76561199446251176','76561199544399975','76561199547722163','76561199550939902',
'76561199567463630','76561199568059571','76561199568157538','76561199570430794','76561199571257636','76561199571362883',
'76561199571425929','76561199571433607','76561199764740698','76561199765157837','76561199765704534','76561199775670455',
'76561199776276558','76561199776413848','76561199776550437','76561199776955517','76561199777075400','76561199777509774',
'76561199793745374','76561198805664714','76561198004945630','76561198005089121','76561198005977073','76561198006879290',
'76561198007472452','76561198007641151','76561198007928124','76561198009550702','76561198011357867','76561198011847661',
'76561198012140577','76561198013055701','76561198013149345','76561198013473595','76561198014819706','76561198016990688',
'76561198017384358','76561198018426169','76561199373052226','76561199379772413','76561199446379804','76561199527793137',
'76561199566727547','76561199567516368','76561199568226101','76561199568530190','76561199571408450','76561199764968404',
'76561199765852620','76561199775869980','76561199776579487','76561199776918199','76561199777147056','76561199777615963',
'76561199783972066','76561198005464810','76561198006076337','76561198006136514','76561198006922091','76561198007995845',
'76561198009680479','76561198010097535','76561198011083696','76561198011654898','76561198012078420','76561198013463444',
'76561198014418469','76561198014999013','76561198017986331','76561198018908460','76561199446684177','76561199465255009',
'76561199465850161','76561199507072615','76561199508668117','76561199566402107','76561199567325996','76561199570741191',
'76561199571100972','76561199571879495','76561199765053560','76561199765274444','76561199765446527','76561199765802072',
'76561199765848215','76561199765852800','76561199766011390','76561199776460352','76561199776589282','76561199776652477',
'76561199776689200','76561199776774879','76561199776789276','76561199776791862','76561199776860875','76561199776919014',
'76561199777135474','76561199777245206','76561199777300408','76561199777400229','76561199777665503','76561198004846927',
'76561198005103884','76561198008288104','76561198009707448','76561198010023554','76561198010632334','76561198011184108',
'76561198011243454','76561198014886283','76561198015601028','76561198015924410','76561199377650171','76561199385402913',
'76561199403103107','76561199429135356','76561199446583682','76561199465981105','76561199466419993','76561199566696238',
'76561199567089894','76561199567639537','76561199567678680','76561199567720222','76561199571002314','76561199776533351',
'76561199776646777','76561199777113093','76561199777250495','76561199411160709','76561198102280473','76561199392617341',
'76561198004844139','76561198006889450','76561198009412163','76561198010886568','76561198011662932','76561198012161631',
'76561198012409767','76561198015349939','76561198017132059','76561199401589703','76561199446771351','76561199465980873',
'76561199467608600','76561199467758085','76561199543484517','76561199543648164','76561199567442373','76561199567616711',
'76561199567803960','76561199568615128','76561199568651694','76561199568768331','76561199568781163','76561199765700459',
'76561199776242247','76561199776721218','76561199776838804','76561199777010613','76561199777348390','76561199777587999',
'76561199777821121','76561199794278569','76561199794293273','76561198005143776','76561198010688905','76561198010769674',
'76561198011006469','76561198013094748','76561198014255177','76561198014701236','76561198016591478','76561198016686151',
'76561198016775570','76561199273226091','76561199362434128','76561199381295803','76561199446864730','76561199465756392',
'76561199516802793','76561199528156608','76561199567004792','76561199567464239','76561199570989197','76561199571470807',
'76561199765179653','76561199765318938','76561199765322650','76561199765491165','76561199776044770','76561199776502064',
'76561199776718304','76561198004966860','76561198007695695','76561198008036230','76561198009661895','76561198009706474',
'76561198010331054','76561198011403847','76561198007695695','76561198008036230','76561198009661895','76561198009706474',
'76561198010331054','76561198011403847','76561198015670377','76561198018912793','76561199375681117','76561199466297684',
'76561199519949770','76561199567046044','76561199567395317','76561199571028206','76561199765398089','76561199765464653',
'76561199776585635','76561199776959449','76561199777006997','76561198004864494','76561198005603961','76561198005693954',
'76561198006797785','76561198007726461','76561198008731728','76561198009976556','76561198010546089','76561198010812774',
'76561198013079603','76561198015047272','76561198015223587','76561198016033011','76561198016213326','76561199370249200',
'76561199375253982','76561199404139434','76561199446874827','76561199567365620','76561199571844391','76561199765138688',
'76561199765896981','76561199776150801','76561199776522288','76561199776557588','76561199776585796','76561199776853904',
'76561199777185557','76561199777384663','76561198004959884','76561198007043258','76561198009589916','76561198010331238',
'76561198010522229','76561198013706384','76561198013817141','76561198016636984','76561199446243758','76561199446422676',
'76561199446827133','76561199468364993','76561199530397306','76561199566851567','76561199567465068','76561199568106645',
'76561199570726640','76561199765158497','76561199765721343','76561199776191763','76561199776458183','76561199776649115',
'76561199776679732','76561199776803906','76561199777232782','76561199027633329','76561199255553934','76561199489701773',
'76561198007198274','76561198008021095','76561198010126056','76561198010627916','76561198010883697','76561198011126764',
'76561198016836560','76561198017006561','76561198017295026','76561199446654705','76561199446758959','76561199468164086',
'76561199504788686','76561199542143787','76561199549632023','76561199550170699','76561199566401971','76561199570688108',
'76561199765516059','76561199775834152','76561199776579551','76561199776748035','76561199777160855','76561199777655344',
'76561198006341639','76561198007592507','76561198007592507','76561198008385687','76561198008776233','76561198009906970',
'76561198010389854','76561198011283031','76561198014533352','76561199396511402','76561199446429307','76561199446590028',
'76561199447321179','76561199447681237','76561199467003563','76561199467038207','76561199566602040','76561199567059031',
'76561199567258430','76561199568182289','76561199571324790','76561199571373895','76561199765016717','76561199765157716',
'76561199765801641','76561199765923132','76561199776514501','76561199776554571','76561199776838871','76561199777117734',
'76561198836321426','76561198004680389','76561198005365746','76561198005378457','76561198006120442','76561198006198828',
'76561198007393184','76561198008819414','76561198009839873','76561198009839873','76561198010725554','76561198011153325',
'76561198011391641','76561198011931311','76561198013173865','76561198016886529','76561199407937441','76561199408021406',
'76561199422692755','76561199465513104','76561199465817040','76561199467089676','76561199467889223','76561199540100467',
'76561199566631232','76561199567163324','76561199776240181','76561199776517116','76561199776798989','76561199776966657',
'76561199777027640','76561199777042210','76561199777297373','76561198006104625','76561198007880941','76561198008004079',
'76561198008183543','76561198008421952','76561198009964291','76561198010692609','76561198013075240','76561198014816482',
'76561198016585175','76561198017428269','76561198018304446','76561198018878153','76561199446221389','76561199446591983',
'76561199466771103','76561199467789512','76561199549769444','76561199566379551','76561199566751207','76561199566757507',
'76561199571162534','76561199571340208','76561199765440238','76561199765634224','76561199765836909','76561199765870088',
'76561199765943369','76561199776258467','76561199776330078','76561199776672197','76561199776818939','76561199776865871',
'76561199776997827','76561199784079725','76561199813015120','76561198975124157','76561199087863201','76561198370901760',
'76561198005604298','76561198005821491','76561198006986415','76561198007128822','76561198007696858','76561198009087710',
'76561198009908453','76561198010692885','76561198012586280','76561198015117601','76561198016690794','76561198018370161',
'76561199338351716','76561199420169507','76561199433107309','76561199446272752','76561199467144736','76561199468330724',
'76561199515105482','76561199548063658','76561199548926066','76561199566883767','76561199567351305','76561199567420909',
'76561199567428711','76561199567812407','76561199568142201','76561199568267585','76561199570876662','76561199570902267',
'76561199571079013','76561199764720827','76561199765101933','76561199765255538','76561199765328081','76561199765650755',
'76561199765665285','76561199766145352','76561199776621131','76561199776672699','76561199777241584','76561199777415643',
'76561199204861718','76561198382898730','76561199393935063','76561198005059987','76561198007427476','76561198012134720',
'76561198016800620','76561198017320718','76561198017494068','76561199467161023','76561199467752460','76561199510804443',
'76561199523135008','76561199566240031','76561199567234711','76561199567420486','76561199568365457','76561199570654648',
'76561199571224199','76561199764937624','76561199765137439','76561199765410486','76561199765602634','76561199766232780',
'76561199766456131','76561199776164591','76561199776315044','76561199776426672','76561199776473326','76561199776840111',
'76561199777359686','76561198872512516','76561198006745578','76561198006946575','76561198008725439','76561198010599021',
'76561198013748141','76561198014150422','76561198017122668','76561199353675296','76561199379219672','76561199384047223',
'76561199529467604','76561199566700856','76561199571240111','76561199571728117','76561199765275674','76561199765503040',
'76561199765733043','76561199766387246','76561199766606614','76561199775997192','76561199776400732','76561199776423467',
'76561199776805328','76561199777143835','76561199777270863','76561199785709919','76561198005946753','76561198006347053',
'76561198007473997','76561198009384540','76561198010426904','76561198010697778','76561198010701687','76561198014343036',
'76561198014785766','76561198015522333','76561198015557211','76561199345939624','76561199378761566','76561199379190559',
'76561199468006456','76561199535747059','76561199548968977','76561199567934293','76561199570946755','76561199765027513',
'76561199765087147','76561199765265535','76561199765448382','76561199775807061','76561199776924527','76561199776945828',
'76561199776945828','76561199777193117','76561199777510966','76561198006066627','76561198007728565','76561198008787541',
'76561198012913338','76561198013652114','76561199413786510','76561199446676042','76561199468420193','76561199468546409',
'76561199523945550','76561199542948816','76561199567260154','76561199571139404','76561199765289529','76561199765776979',
'76561199766014695','76561199776271475','76561199776422786','76561199776938794','76561199777385954','76561199082817407',
'76561198005503229','76561198008014189','76561198008226184','76561198009225024','76561198009660082','76561198010326448',
'76561198013084027','76561198017798014','76561199446230434','76561199465729517','76561199518051255','76561199548434865',
'76561199567159739','76561199568321147','76561199764901496','76561199765562504','76561199765870168','76561199766087802',
'76561199776350514','76561199776457783','76561199776774929','76561199776833048','76561199777085953','76561199777215404',
'76561199812411922','76561198005553686','76561198006264912','76561198007959783','76561198009399587','76561198010319016',
'76561198010882303','76561198013227416','76561198014026944','76561198014575983','76561198015041968','76561198015041968',
'76561198015353730','76561199446204054','76561199446975850','76561199466130789','76561199467597782','76561199467658612',
'76561199551086267','76561199566123874','76561199566756134','76561199567283778','76561199568215321','76561199570648614',
'76561199571184672','76561199571348425','76561199571483280','76561199765143599','76561199765987367','76561199777291438',
'76561199777397795','76561198008809944','76561198011676581','76561198011902439','76561198018895444','76561198018925063',
'76561199384163610','76561199405302264','76561199446225994','76561199447565901','76561199545907161','76561199566706351',
'76561199566818027','76561199566935080','76561199765239160','76561199765428556','76561199765735339','76561199765820248',
'76561199776097381','76561199776314613','76561199776338784','76561199776399027','76561199776455785','76561199776598604',
'76561199776637308','76561199777159476','76561199777171243','76561199777221340','76561199777400171','76561199777542144',
'76561199706987238','76561199122392783','76561198004828825','76561198005207764','76561198005913807','76561198006184040',
'76561198007754099','76561198009210146','76561198011245857','76561198014151987','76561198017736079','76561199466073103',
'76561199550502782','76561199566421502','76561199566757891','76561199567272841','76561199567481200','76561199567569663',
'76561199567859019','76561199567983975','76561199568698326','76561199765653894','76561199766054318','76561199776052797',
'76561199776150794','76561199777218748','76561199777310195','76561199370265843','76561198334971090','76561198347741495',
'76561198007110652','76561198007370106','76561198007389094','76561198007507551','76561198008114211','76561198011538414',
'76561198012698193','76561198012735804','76561198013555534','76561198015948352','76561198018642886','76561199296352562',
'76561199379897551','76561199417822789','76561199433260336','76561199465767361','76561199466361426','76561199566729632',
'76561199567553571','76561199764823966','76561199765348651','76561199765974250','76561199776778591','76561199776791274',
'76561199777101767','76561199777144655','76561199777146810','76561199812918942','76561198005026946','76561198005386198',
'76561198005401475','76561198009975944','76561198010330326','76561198011019916','76561198012310894','76561198015799768',
'76561198017424179','76561198017514265','76561199467017105','76561199527931768','76561199549738355','76561199567299527',
'76561199571284054','76561199571713676','76561199764925277','76561199765273624','76561199765483099','76561199765736201',
'76561199765822403','76561199765963870','76561199766151956','76561199776439183','76561199776462120','76561199776803475',
'76561199776864298','76561199777362272','76561199241013396','76561198829409181','76561198004981593','76561198005307719',
'76561198005770815','76561198005844954','76561198006933082','76561198007516773','76561198008786457','76561198010977195',
'76561198011722355','76561198010977195','76561198011722355','76561198012980716','76561198014049950','76561199445973752',
'76561199466919670','76561199467539184','76561199524793370','76561199567015950','76561199567800699','76561199567895683',
'76561199568329089','76561199568353191','76561199571447442','76561199765324223','76561199765421018','76561199766062984',
'76561199766187274','76561199766276445','76561199766410093','76561199776788016','76561199776795203','76561199776897086',
'76561199777268277','76561199777549122','76561199382218943','76561198005261187','76561198006048951','76561198010369451',
'76561198010779993','76561198014821157','76561198014920029','76561198015073259','76561198016369248','76561198017074984',
'76561198017924433','76561199445739829','76561199525479726','76561199551030230','76561199567319489','76561199570870266',
'76561199571718803','76561199572116851','76561199765331960','76561199765943931','76561199776442296','76561199777086911',
'76561199777133557','76561199777270562','76561199777408817','76561198326829681','76561198006464721','76561198008055909',
'76561198008352606','76561198009220639','76561198009470466','76561198010543006','76561198013862908','76561198016882998',
'76561198018338436','76561199468040989','76561199535293007','76561199568196051','76561199571455406','76561199764899321',
'76561199765509439','76561199765536987','76561199765865550','76561199765954855','76561199765967649','76561199766179388',
'76561199776266363','76561199776641111','76561199776668679','76561198006736624','76561198008683802','76561198009204336',
'76561198012546018','76561198012710131','76561198012910286','76561198014016508','76561198014201742','76561198017535132',
'76561199304428571','76561199388175889','76561199393581871','76561199400405397','76561199421956882','76561199467503373',
'76561199467946568','76561199516045001','76561199528937672','76561199566703325','76561199567094925','76561199567172242',
'76561199567446438','76561199568065557','76561199568308588','76561199570366187','76561199765025823','76561199765027944',
'76561199775722530','76561199776308174','76561199776334408','76561199777010182','76561199777476084','76561198009502342',
'76561198010140680','76561198011818031','76561198015842160','76561198016406577','76561198016956959','76561198017752992',
'76561198017912878','76561199310000673','76561199438400364','76561199525854607','76561199550805906','76561199567093439',
'76561199571182951','76561199571798463','76561199765152222','76561199765250679','76561199765273316','76561199765847415',
'76561199766155673','76561199776039317','76561199776773694','76561199776788602','76561199776884497','76561199777327151',
'76561199777591447','76561199777636979','76561198324503325','76561198008334210','76561198010770119','76561198015002797',
'76561198018976484','76561199379708101','76561199447169577','76561199447242615','76561199466524377','76561199466918915',
'76561199529114102','76561199529594666','76561199538217456','76561199538809425','76561199568027179','76561199765150065',
'76561199765681333','76561199766160006','76561199766690969','76561199776584342','76561199777106628','76561198932052072',
'76561198005555809','76561198008905837','76561198009262040','76561198009963456','76561198010885909','76561198011432806',
'76561198012548592','76561198012777496','76561198017180553','76561198017225823','76561198017706238','76561199446214456',
'76561199447523700','76561199542027127','76561199542474035','76561199568039151','76561199571229299','76561199571886626',
'76561199765488010','76561199765504853','76561199765772206','76561199776095483','76561199776304924','76561199776746742',
'76561199813004027','76561199813727639','76561198969039323','76561199037153902','76561199393667433','76561199432781746',
'76561199514628344','76561198106795576','76561198008860361','76561198009691817','76561198011027580','76561198012039399',
'76561198015459013','76561198016406671','76561198017104238','76561199382835585','76561199404957833','76561199405313551',
'76561198009589402','76561198011596914','76561198012050126','76561198013490486','76561198014426470','76561198014710796',
'76561198018903405','76561199466548010','76561199466851273','76561199567383344','76561199567816022','76561199568608467',
'76561199765206957','76561199765922701','76561199776503652','76561199776829169','76561199777006708','76561199777170633',
'76561199777514650','76561199784642139','76561198005420411','76561198007032219','76561198009432113','76561198009434282',
'76561198010835185','76561198011254655','76561198012113234','76561198014691809','76561198014948477','76561198019021703',
'76561199404885154','76561199446031116','76561199446550013','76561199466295850','76561199548624286','76561199566962868',
'76561199567979303','76561199568812119','76561199765678246','76561199766236159','76561199776474656','76561199777381644',
'76561199777396568','76561199360887448','76561198824059420','76561198004769816','76561198005409959','76561198005609489',
'76561198005790439','76561198005965684','76561198006180274','76561198007003157','76561198007396365','76561198007435015',
'76561198010387964','76561198011380812','76561198011761673','76561198012213663','76561198014713944','76561198014744586',
'76561199395885895','76561199416184038','76561199446689549','76561199466329558','76561199466670389','76561199468429313',
'76561199512988976','76561199549405144','76561199566480863','76561199567080599','76561199567155302','76561199567558130',
'76561199571452761','76561199764976655','76561199765150004','76561199776458560','76561199776851981','76561199776988473',
'76561199777000674','76561199777197252','76561198005369917','76561198007835147','76561198008144448','76561198008914480',
'76561198010177066','76561198014399181','76561198017584224','76561198017893131','76561198018127409','76561199446853178',
'76561199447008361','76561199466212626','76561199466290371','76561199550650781','76561199567835529','76561199568153100',
'76561199568807141','76561199572118865','76561199766009666','76561199766095263','76561199766214988','76561199776241816',
'76561199776764028','76561199777097479','76561199777741907','76561198005626593','76561198009610083','76561198010017597',
'76561198010839600','76561198011400756','76561198011975071','76561198012946066','76561198013501600','76561198013750544',
'76561198015119365','76561198016077569','76561198016464847','76561198017064062','76561198017601255','76561198017794643',
'76561199341852209','76561199374937459','76561199446570172','76561199506356111','76561199548311144','76561199567387855',
'76561199567400387','76561199567557421','76561199776719819','76561199776819562','76561199776907235','76561199777096361',
'76561199777193546','76561199777655775','76561198010740475','76561198012546054','76561198014442866','76561198016606373',
'76561198017150499','76561198018468151','76561199354191904','76561199400498295','76561199446659857','76561199467233549',
'76561199522214191','76561199543543900','76561199567271811','76561199567340709','76561199567551652','76561199568240462',
'76561199568639571','76561199570908348','76561199571887589','76561199764437686','76561199764480080','76561199765475660',
'76561199765669804','76561199765702691','76561199766193109','76561199775894282','76561199775994498','76561199776459490',
'76561199777657700','76561199777673537','76561199788931795','76561199812533994','76561199812674158','76561197992031275',
'76561197997395844','76561197999288193','76561198003873146','76561198006758532','76561198011331475','76561198020142935',
'76561198026939958','76561199548052315','76561199695207567','76561198011379958','76561198012182579','76561198013212018',
'76561198016132966','76561198016143866','76561198016804963','76561198018079103','76561198018592541','76561198019031938',
'76561199377471035','76561199384245715','76561199446126180','76561199446402330','76561199446582947','76561199447054451',
'76561199466899771','76561199521499842','76561199538598417','76561199549677360','76561199566787009','76561199566962159',
'76561199567218960','76561199571056112','76561199764926697','76561199765415531','76561199765429782','76561199765696126',
'76561199775940472','76561199776079829','76561199776079829','76561199776220246','76561199776421312','76561199776902883',
'76561199777233337','76561199777311837','76561199814934820','76561198005719966','76561198006147922','76561198006156709',
'76561198006644169','76561198007618424','76561198008619809','76561198010204228','76561198010372480','76561198012414130',
'76561198017503151','76561198018686273','76561199303196019','76561199388520601','76561199406725431','76561199446982649',
'76561199530667453','76561199533852645','76561199535250198','76561199543880498','76561199567683479','76561199567760281',
'76561199567839182','76561199380312174','76561199446440715','76561199447033921','76561199465845702','76561199523386290',
'76561199530439274','76561199536277381','76561199566671650','76561199567932034','76561199567966364','76561199570934734',
'76561199765446271','76561199775997623','76561199776364436','76561199776560135','76561199776641078','76561199776668636',
'76561199776728013','76561199776877195','76561199776927055','76561199154346639','76561198005136004','76561198006732672',
'76561198012305613','76561198014195305','76561198014653823','76561198016393513','76561198016824223','76561199446444961',
'76561199530056086','76561199552007580','76561199566272589','76561199566771638','76561199567244235','76561199567567004',
'76561199567807289','76561199570992855','76561199571578588','76561199765262949','76561199765878812','76561199776649299',
'76561199776801361','76561199777001886','76561199777625598','76561199777637102','76561198005207618','76561198005592234',
'76561198005614429','76561198008765977','76561198009296273','76561198010004259','76561198015831951','76561198016611836',
'76561198017975991','76561198018115654','76561198018375446','76561199446716782','76561199466362103','76561199467055307',
'76561199549225282','76561199567111712','76561199570614347','76561199571369090','76561199765159359','76561199765184073',
'76561199765368219','76561199765392020','76561199766795393','76561199777330918','76561199777485109','76561199777632792',
'76561198005732669','76561198006412168','76561198007394507','76561198008638158','76561198009159875','76561198009649481',
'76561198009778619','76561198010613040','76561198012033792','76561198013265361','76561198013625147','76561198015835497',
'76561198018105836','76561199385295902','76561199413992259','76561199548129239','76561199566948579','76561199572003534',
'76561199765054422','76561199765261997','76561199765263259','76561199766096508','76561199776469929','76561199777016731',
'76561199777334797','76561198005401579','76561198006054223','76561198010263695','76561198011087344','76561198012932259',
'76561198014542495','76561198014696943','76561198014765827','76561198015851215','76561198016465546','76561198018707937',
'76561199446496965','76561199466466213','76561199466631227','76561199466932827','76561199467189655','76561199509321498',
'76561199528482939','76561199567680326','76561199571611422','76561199571741366','76561199571794860','76561199765331529',
'76561199765488538','76561199776428315','76561199776452803','76561199776855892','76561199776921839','76561199777250926',
'76561199777375759','76561199812875500','76561198377583650','76561198006123770','76561198006162491','76561198008056579',
'76561198008240744','76561198009262623','76561198009667967','76561198011636623','76561198015388428','76561198016010284',
'76561198018895194','76561199406741533','76561199446136303','76561199446545035','76561199446747765','76561199446966266',
'76561199465440047','76561199466881124','76561199544322508','76561199567228410','76561199567603120','76561199764886642',
'76561199765334304','76561199765449686','76561199765699140','76561199766322179','76561199775981137','76561199776485637',
'76561199777026778','76561199777142739','76561199777503642','76561199778206744','76561199060246754','76561198004990732',
'76561198005309760','76561198007422336','76561198007684939','76561198010026376','76561198010696751','76561198013731734',
'76561198016275327','76561198017753388','76561199444955727','76561199446323278','76561199466640588','76561199467095937',
'76561199530243261','76561199543074177','76561199566698802','76561199567809066','76561199568125848','76561199570747280',
'76561199776253110','76561199776713789','76561199776801792','76561199776867164','76561199777038746','76561199777073102',
'76561199777144539','76561198005547650','76561198007576393','76561198010159648','76561198016463755','76561198018046534',
'76561198018536504','76561198018883779','76561199328739904','76561199353601719','76561199379648824','76561199446735955',
'76561199525187529','76561199533050545','76561199540089551','76561199566796113','76561199567848027','76561199571632851',
'76561199765134392','76561199765440292','76561199775748678','76561199776182383','76561199776401594','76561199776525118',
'76561199776401594','76561199776525118','76561199776730656','76561199776747366','76561199776791654','76561199776895793',
'76561199777385843','76561199777559603','76561199777715989','76561198004993982','76561198009159089','76561198009736203',
'76561198016198326','76561198016840349','76561198016917024','76561198018807428','76561199351850709','76561199375838814',
'76561199446370781','76561199466942307','76561199467900809','76561199508651637','76561199509989434','76561199541355879',
'76561199549128399','76561199566693246','76561199567095214','76561199567292771','76561199567711717','76561199571158497',
'76561199765673749','76561199765924526','76561199766158282','76561199775900316','76561199776411292','76561199776567392',
'76561199777049175','76561199777083416','76561199777311723','76561198004732427','76561198005409311','76561198009746913',
'76561198009758414','76561198011032646','76561198011592846','76561198012409490','76561198012526213','76561198012835064',
'76561198012841061','76561198013756607','76561198016737912','76561198017411630','76561199542467695','76561199567507960',
'76561199567946496','76561199570961768','76561199776101410','76561199776205885','76561199776264484','76561199776584659',
'76561199776796382','76561199776807710','76561199776909613','76561199776937618','76561199776978002','76561199777015576',
'76561199777017780','76561199777097888','76561199777166372','76561199777452813','76561199199853955','76561199377782487',
'76561198863744858','76561199341990999','76561198006261827','76561198007134264','76561198010141538','76561198010705206',
'76561198011994279','76561198012510489','76561198015458539','76561198016036373','76561198016938314','76561199433061447',
'76561199446340449','76561199514202577','76561199525071795','76561199539123978','76561199545137025','76561199549741287',
'76561199567003699','76561199567220980','76561199567361828','76561199571216283','76561199571346600','76561199571746394',
'76561199571975559','76561199764982627','76561199765160328','76561199765356554','76561199766258657','76561199775811256',
'76561199776389735','76561199776459594','76561199776531382','76561199776805630','76561199777088673','76561199777636893',
'76561198005340956','76561198006034488','76561198008879407','76561198010560097','76561198010969147','76561198011233505',
'76561198012184306','76561198012515756','76561198013517426','76561198014227513','76561198015431216','76561198017543482',
'76561198017574615','76561199349028406','76561199349455532','76561199417199089','76561199446409588','76561199467519075',
'76561199508638490','76561199567110675','76561199567325036','76561199567512003','76561199567616027','76561199764986149',
'76561199775327810','76561199776298432','76561199776462551','76561199776540502','76561199776726623','76561199776963366',
'76561199777130022','76561199777277755','76561199777396502','76561199777490196','76561199777535506','76561199182158763',
'76561198005312079','76561198007209455','76561198009064869','76561198012125920','76561198013798657','76561198014305747',
'76561198015099498','76561198015917513','76561198018090099','76561199403489916','76561199407601141','76561199446156347',
'76561199446269464','76561199446584623','76561199508275527','76561199566578099','76561199567437484','76561199568656908',
'76561199571142857','76561199571447657','76561199765523569','76561199776340682','76561199776547149','76561199776558732',
'76561199776714651','76561199777692260','76561199579841461','76561199529345216','76561199028993776','76561198005636023',
'76561198006348073','76561198006594553','76561198006981822','76561198007998605','76561198008591126','76561198010441955',
'76561198013811357','76561198014029990','76561198018113506','76561198018154773','76561199390571718','76561199437732767',
'76561199442810961','76561199466404747','76561199508814837','76561199540372506','76561199549856749','76561199566810266',
'76561199566993107','76561199567108518','76561199567243400','76561199567244874','76561199567394654','76561199571277115',
'76561199571444435','76561199571847128','76561199765368698','76561199775896079','76561199776089128','76561199776533078',
'76561199776649891','76561199776856921','76561199776895883','76561199777152398','76561199777450651','76561199107678194',
'76561199443023317','76561199109147109','76561198986268358','76561199293829972','76561198979935067','76561198004853082',
'76561198005045174','76561198005413628','76561198006254275','76561198006445953','76561198006445953','76561198006875221',
'76561198007483577','76561198007584398','76561198008308826','76561198009199454','76561198009251809','76561198010123802',
'76561198011614902','76561198012883402','76561198013137248','76561198014113378','76561198014570062','76561198014850496',
'76561199368198223','76561199391059491','76561199416814436','76561199465773524','76561199544298794','76561199566942065',
'76561199765022777','76561199765121879','76561199765127001','76561199765611308','76561199765690446','76561199765932725',
'76561199775518458','76561199775810825','76561199775923265','76561199776272796','76561199776488826','76561199776523458',
'76561199776684811','76561199776989946','76561199777023595','76561199777157324','76561199777961485','76561198806087359',
'76561198005262556','76561198006259655','76561198009551970','76561198009754634','76561198014657686','76561198014657686',
'76561198017096501','76561198017548946','76561199369617636','76561199415686685','76561199417092089','76561199421564583',
'76561199543647366','76561199551414456','76561199566640714','76561199566972059','76561199567610619','76561199567751719',
'76561199570907444','76561199571121833','76561199571465887','76561199764664919','76561199765008257','76561199765361261',
'76561199765605007','76561199776440572','76561199776576930','76561199776768968','76561199777073535','76561199777179794',
'76561199413522336','76561198004910197','76561198004942664','76561198006105067','76561198006371480','76561198007410202',
'76561198007434431','76561198010062333','76561198010422528','76561198011562446','76561198011871134','76561198012308803',
'76561198013442020','76561198014537261','76561199377940383','76561199384137001','76561199384897186','76561199391961151',
'76561199417003110','76561199429369783','76561199447357513','76561199467482093','76561199516571797','76561199528979924',
'76561199551353094','76561199566451635','76561199566990565','76561199567050700','76561199567162907','76561199567340874',
'76561199567353710','76561199567967852','76561199570870579','76561199571193874','76561199572123099','76561199765006533',
'76561199775578605','76561199775990619','76561199776271906','76561199776831353','76561199777230638','76561199777383368',
'76561198008214621','76561198009107992','76561198010641198','76561198014265931','76561198014426916','76561198015472070',
'76561199389121434','76561199446445407','76561199446845326','76561199467555703','76561199467964830','76561199528216078',
'76561199540854084','76561199542398824','76561199545360307','76561199566743928','76561199566893263','76561199567065804',
'76561199568324202','76561199571614538','76561199765555125','76561199765566076','76561199765846922','76561199765957520',
'76561199766162412','76561199776297570','76561199776718209','76561199777182299','76561199777220305','76561198005971104',
'76561198006303788','76561198007721265','76561198009264457','76561198009789164','76561198010256215','76561198018140735',
'76561198018147388','76561199302750896','76561199393498887','76561199527326188','76561199543733379','76561199548129353',
'76561199566216834','76561199567110186','76561199568007989','76561199571215093','76561199571448347','76561199571822805',
'76561199765907925','76561199776515013','76561199776856432','76561199776857294','76561199776916558','76561199776937321',
'76561199777510205','76561199777764978','76561199057266622','76561199239460540','76561198006643351','76561198007599955',
'76561198010806996','76561198016663102','76561199432233553','76561199468058219','76561199509097624','76561199566988206',
'76561199567310910','76561199568315817','76561199571401318','76561199765160652','76561199765427934','76561199765771299',
'76561199765870142','76561199766237434','76561199766364261','76561199766401038','76561199777347097','76561199777377771',
'76561199777476587','76561199777501179','76561199777698088','76561199812158526','76561198006471892','76561198007518428',
'76561198010944408','76561198013413740','76561198014740357','76561198017863507','76561199382822536','76561199403518009',
'76561199435128016','76561199446603736','76561199505831647','76561199541826376','76561199547921248','76561199549570456',
'76561199566939706','76561199566966527','76561199571317558','76561199765599035','76561199765694705','76561199765897412',
'76561199775941765','76561199776269712','76561199776347738','76561199776883481','76561199777085123','76561199777681557',
'76561199814341362','76561198029163542','76561198007396437','76561198009921409','76561198010004914','76561198012165816',
'76561198013429355','76561198016646594','76561198017792721','76561198018185114','76561199346975510','76561199466339490',
'76561199467377580','76561199548674019','76561199567551035','76561199568044335','76561199571018935','76561199765159561',
'76561199765339547','76561199765356123','76561199765544019','76561199765624396','76561199765895097','76561199766109709',
'76561199776291704','76561199776323894','76561199776367868','76561199776717873','76561199776847076','76561199777264290',
'76561199777384232','76561198083911990','76561198823272804','76561198011463461','76561198012896264','76561198013371748',
'76561198014229233','76561198014827529','76561198018013011','76561198018873228','76561199304727491','76561199446486250',
'76561199447096775','76561199466277620','76561199466773531','76561199467465269','76561199551504977','76561199567441656',
'76561199571257915','76561199571357188','76561199764986923','76561199765107764','76561199765339978','76561199776227972',
'76561199776277151','76561199776471437','76561199776481874','76561198234572528','76561198005913963','76561198009094893',
'76561198009148390','76561198011134776','76561198011963171','76561198013815845','76561198015867075','76561199406558938',
'76561199411573585','76561199446497386','76561199523291392','76561199524957711','76561199530323897','76561199537550301',
'76561199543279956','76561199546216945','76561199566879425','76561199567591601','76561199567733297','76561199568227124',
'76561199568285999','76561199765238044','76561199765931863','76561199776355732','76561198005330751','76561198005872991',
'76561198005914415','76561198006624051','76561198006863687','76561198006990867','76561198010107754','76561198010834123',
'76561198010920993','76561198011675769','76561198012469327','76561198013084228','76561198013762949','76561198015961545',
'76561198016468596','76561198016559844','76561199402833272','76561199446670718','76561199468515335','76561199517035388',
'76561199540330441','76561199551104444','76561199567179453','76561199567624461','76561199571260796','76561199571537805',
'76561199764598420','76561199765148260','76561199765157285','76561199765734367','76561199765883796','76561199765957951',
'76561199776376909','76561199776472895','76561199777347701','76561199777401091','76561199777429432','76561198005261068',
'76561198008993174','76561198009828467','76561198010061788','76561198010293873','76561198010313269','76561198011117232',
'76561198011675597','76561198013115450','76561198015277963','76561198015744115','76561199400920472','76561199544153819',
'76561199549556793','76561199567256089','76561199568018838','76561199568040787','76561199571350663','76561199571839846',
'76561199764560775','76561199765428920','76561199765624690','76561199766110438','76561199776108865','76561199776425675',
'76561199776789033','76561199777016774','76561199777070152','76561199777158063','76561199777383799','76561199789133196',
'76561199402259485','76561198004949512','76561198007231196','76561198007691738','76561198007862913','76561198008918514',
'76561198009165700','76561198011456783','76561198013152070','76561198015589538','76561198016825226','76561199440329992',
'76561199447187603','76561199465691179','76561199466213245','76561199543392038','76561199543872884','76561199550454722',
'76561199566545671','76561199567184978','76561199567573482','76561199569025375','76561199765904599','76561199776057937',
'76561199776422605','76561199776451355','76561199776462191','76561199776465639','76561199776633170','76561199777231920',
'76561198007079530','76561198009979732','76561198011307712','76561198011545319','76561198013087188','76561198014206697',
'76561198016568779','76561199384544755','76561199421357473','76561199446365967','76561199446430030','76561199466391009',
'76561199566717853','76561199566910710','76561199567146068','76561199567281992','76561199567365540','76561199567535968',
'76561199570756844','76561199571347771','76561199765336230','76561199765349513','76561199765427680','76561199765740019',
'76561199765867592','76561199776276720','76561199776458129','76561199777417530','76561199777557904','76561199491643112',
'76561198005285287','76561198007737537','76561198008633495','76561198009653441','76561198009838621','76561198010538509',
'76561198010538509','76561198012461352','76561198012862531','76561198013656460','76561198014447074','76561198014555443',
'76561198015224387','76561198015242331','76561198017072994','76561198018431389','76561199389229735','76561199406976257',
'76561199467004286','76561199549338093','76561199566780045','76561199567598229','76561199567844078','76561199765237318',
'76561199765250137','76561199775936493','76561199776662639','76561199776801575','76561199776837942','76561198005224742',
'76561198005686642','76561198005841879','76561198009609743','76561198011302411','76561198011608446','76561198011781902',
'76561198012040094','76561198012136806','76561198013015383','76561198013235305','76561198015964792','76561199405196073',
'76561199433470730','76561199440426041','76561199442828324','76561199467961399','76561199513296404','76561199567143778',
'76561199568199855','76561199571236657','76561199571406421','76561199764921353','76561199765143754','76561199765519048',
'76561199765569524','76561199765884391','76561199766020872','76561199776045632','76561199776354621','76561199776356163',
'76561199776451352','76561199776763772','76561199776909182','76561199776917726','76561199776991720','76561199777312038',
'76561199777456600','76561199777681433','76561199790440207','76561199813648634','76561198421101628','76561199434743685',
'76561198006420655','76561198007084243','76561198008729196','76561198010021189','76561198010446709','76561198014142655',
'76561198014870015','76561198018193060','76561198018275344','76561199374872408','76561199407262632','76561199446994558',
'76561199467442731','76561199545871574','76561199566938369','76561199567928727','76561199568158351','76561199570888730',
'76561199571718372','76561199764427773','76561199764952886','76561199765386021','76561199765437200','76561199765604864',
'76561199765730889','76561199776126546','76561199776515887','76561199777075399','76561199777261190','76561199777398505',
'76561199791286840','76561198008065572','76561198009471264','76561198010179757','76561198010720188','76561198012129708',
'76561198013547725','76561198013985915','76561198014476856','76561198015302893','76561198016960635','76561198017341815',
'76561198017841276','76561198018907902','76561199436001726','76561199523358440','76561199542230666','76561199543376183',
'76561199566829180','76561199568157305','76561199568339393','76561199571072854','76561199571225862','76561199571400836',
'76561199765138638','76561199765440723','76561199766113585','76561199775691781','76561199776577410','76561199776767246',
'76561199777291007','76561199777632512','76561198005559267','76561198005619274','76561198005628269','76561198006430149',
'76561198006900918','76561198007702404','76561198010017307','76561198010483856','76561198012597220','76561198014184674',
'76561198016761992','76561198017728322','76561199333034926','76561199777141091','76561199777852031','76561199192568777',
'76561199060849328','76561198004754554','76561198005853539','76561198007610562','76561198007821337','76561198008828743',
'76561198009025722','76561198009980276','76561198010273440','76561198014396348','76561198019063274','76561199442210275',
'76561199446836495','76561199447413320','76561199466125290','76561199467210841','76561199545735862','76561199549753045',
'76561199567531458','76561199567621737','76561199567979053','76561199567996507','76561199568358386','76561199570674998',
'76561199570898897','76561199776353803','76561199776411947','76561199777433090','76561199413176143','76561199776575485',
'76561199776649669','76561199776946259','76561199777097231','76561199777319010','76561199777509077','76561199777698004',
'76561198007987601','76561198009834860','76561198010462722','76561198011162719','76561198012933752','76561198013342628',
'76561198013997577','76561198014417637','76561199377350939','76561199415780492','76561199567414211','76561199567416415',
'76561199567733491','76561199568041376','76561199571122493','76561199571665383','76561199764600575','76561199764779028',
'76561199765723077','76561199776292709','76561199776724716','76561199776788232','76561199776790569','76561199776866150',
'76561199777046192','76561199777454445','76561199777497834','76561199766284145','76561199776575485','76561199776649669',
'76561199776946259','76561199777097231','76561199777319010','76561199777509077','76561199777698004','76561198007987601',
'76561198009834860','76561198010462722','76561198011162719','76561198012933752','76561198013342628','76561198013997577',
'76561198014417637','76561199377350939','76561199415780492','76561199567414211','76561199567416415','76561199567733491',
'76561199568041376','76561199571122493','76561199571665383','76561199764600575','76561199764779028','76561199765723077',
'76561199776292709','76561199776724716','76561199776788232','76561199776790569','76561199776866150','76561199777046192',
'76561199777454445','76561199777497834','76561199777497834','76561198409447909','76561198004995606','76561198006368425',
'76561198006825154','76561198010402278','76561198010752037','76561198011861600','76561198014417971','76561198015743639',
'76561199381658862','76561199389606659','76561199393669523','76561199446527992','76561199446854755','76561199467115962',
'76561199530375606','76561199550075625','76561199550368918','76561199550571258','76561199567193681','76561199567310248',
'76561199567415234','76561199568043799','76561199568059592','76561199568764412','76561199570904006','76561199571941381',
'76561199765150674','76561199765974667','76561199776044339','76561199776180639','76561199776378202','76561199776404908',
'76561199776463053','76561199777474680','76561198006066024','76561198006234482','76561198007227642','76561198007881511',
'76561198011941995','76561198013701859','76561198014547644','76561198015235007','76561198015393841','76561198015622422',
'76561198016010007','76561198016383587','76561198016807802','76561198017349924','76561199468150454','76561199548107619',
'76561199567117977','76561199568068255','76561199764922701','76561199765538908','76561199765560702','76561199766060643',
'76561199767203905','76561199776664620','76561199776672723','76561199777061431','76561199777116628','76561199777287969',
'76561199812007220','76561198004884212','76561198005171324','76561198006474078','76561198008308398','76561198009149363',
'76561198010108290','76561199765262077','76561199765429351','76561199766155815','76561199776666726','76561199776740288',
'76561199777085656','76561199777173107','76561199777414214','76561199777969808','76561199385811241','76561198006088707',
'76561198007427862','76561198010587164','76561198012307660','76561198012601837','76561198012757648','76561198017646818',
'76561198018768782','76561199405183452','76561199412325981','76561199417486589','76561199445724465','76561199518495223',
'76561199550132181','76561199566995113','76561199567709428','76561199765248978','76561199765766893','76561199766125910',
'76561199776456793','76561199776533899','76561199776816241','76561199777019748','76561199777250064','76561198005718983',
'76561198006052279','76561198009163530','76561198009962076','76561198010242002','76561198010578651','76561198012052284',
'76561198012286811','76561198016167919','76561198017678994','76561198018942191','76561199409656328','76561199443997801',
'76561199446715756','76561199467558609','76561199468222286','76561199549180576','76561199549310180','76561199550123328',
'76561199567010911','76561199571353372','76561199571971145','76561199764721689','76561199765028006','76561199765707537',
'76561199765871131','76561199446715756','76561199467558609','76561199468222286','76561199549180576','76561199549310180',
'76561199550123328','76561199567010911','76561199571353372','76561199571971145','76561199764721689','76561199765028006',
'76561199765707537','76561199765871131','76561199765940380','76561199766038755','76561199766429057','76561199776231227',
'76561199776483813','76561199776857725','76561199776888932','76561199777216323','76561199777476900','76561199777490769',
'76561198004994805','76561198005650167','76561198005755344','76561198007264635','76561198012541515','76561198014311593',
'76561198017570415','76561199446745892','76561199447454626','76561199447620684','76561199467035314','76561199467249205',
'76561198005755344','76561198007264635','76561198012541515','76561198014311593','76561198017570415','76561199446745892',
'76561199447454626','76561199447620684','76561199467035314','76561199467249205','76561199566966341','76561199566987054',
'76561199567372551','76561199567400082','76561199568481000','76561199571146897','76561199571536943','76561199571710917',
'76561199572052353','76561199764701977','76561199765138637','76561199765142021','76561199765252403','76561199765378676',
'76561199765500590','76561199765833542','76561199776307361','76561199776673276','76561199776926251','76561198005826517',
'76561198006844976','76561198007943714','76561198011141465','76561198012280865',

    
    #GirlGamers
    
    
]


DATA_FILE = 'friend_data.json'
INIT_FILE = '.initialized'

# Optimized rate limiting configuration for speed
MAX_CONCURRENT_REQUESTS = 50  # High concurrency
REQUEST_DELAY = 0.1  # Very short delay between requests
BURST_SIZE = 100  # Allow bursts of requests
BURST_DELAY = 5  # Pause after each burst
MAX_RETRIES = 2  # Limit retries to keep speed up

logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')
logger = logging.getLogger("SteamFriendIDMonitor")

class FastRateLimiter:
    def __init__(self, max_concurrent=50, burst_size=100, burst_delay=5):
        self.semaphore = asyncio.Semaphore(max_concurrent)
        self.burst_size = burst_size
        self.burst_delay = burst_delay
        self.request_count = 0
        self.last_burst_reset = None
        self.loop = None
    
    async def acquire(self):
        if self.loop is None:
            self.loop = asyncio.get_event_loop()
            self.last_burst_reset = self.loop.time()
        
        await self.semaphore.acquire()
        
        # Check if we need to pause after a burst
        self.request_count += 1
        if self.request_count >= self.burst_size:
            current_time = self.loop.time()
            time_since_reset = current_time - self.last_burst_reset
            
            if time_since_reset < self.burst_delay:
                sleep_time = self.burst_delay - time_since_reset
                logger.debug(f"Burst limit reached, sleeping for {sleep_time:.2f}s")
                await asyncio.sleep(sleep_time)
            
            self.request_count = 0
            self.last_burst_reset = self.loop.time()
        
        # Small delay to prevent hammering
        await asyncio.sleep(0.05 + random.uniform(0, 0.05))
    
    def release(self):
        self.semaphore.release()

# Rate limiter will be created inside the main function

def get_profile_link(steam_id):
    """Generate Steam profile link from Steam ID"""
    return f"steamcommunity.com/profiles/{steam_id}"

async def fetch_friend_list(session, steam_id, rate_limiter, retry_count=0):
    """Fetch the complete friend list for a Steam account with optimized rate limiting"""
    url = f"http://api.steampowered.com/ISteamUser/GetFriendList/v0001/?key={STEAM_API_KEY}&steamid={steam_id}&relationship=friend"
    profile_link = get_profile_link(steam_id)
    
    await rate_limiter.acquire()
    try:
        async with session.get(url, timeout=10) as resp:
            if resp.status == 200:
                data = await resp.json()
                friends_data = data.get('friendslist', {}).get('friends', [])
                friend_ids = [friend['steamid'] for friend in friends_data]
                return steam_id, profile_link, friend_ids
            elif resp.status == 403:
                logger.debug(f"{profile_link} is private")
                return steam_id, profile_link, None
            elif resp.status in [429, 420]:
                if retry_count < MAX_RETRIES:
                    # Exponential backoff for rate limits
                    delay = (2 ** retry_count) + random.uniform(0, 1)
                    logger.warning(f"{profile_link}: Rate limited, retrying in {delay:.2f}s")
                    await asyncio.sleep(delay)
                    return await fetch_friend_list(session, steam_id, rate_limiter, retry_count + 1)
                else:
                    logger.error(f"{profile_link}: Max retries exceeded for rate limit")
                    return steam_id, profile_link, None
            else:
                logger.warning(f"{profile_link}: API error {resp.status}")
                return steam_id, profile_link, None
    except asyncio.TimeoutError:
        logger.warning(f"Timeout fetching {profile_link}")
        return steam_id, profile_link, None
    except Exception as e:
        logger.warning(f"Error fetching {profile_link}: {e}")
        return steam_id, profile_link, None
    finally:
        rate_limiter.release()

async def send_telegram_message(message):
    """Send message to Telegram, splitting if too long"""
    MAX_MESSAGE_LENGTH = 4000
    
    if len(message) <= MAX_MESSAGE_LENGTH:
        await _send_single_message(message)
    else:
        lines = message.split('\n')
        current_chunk = ""
        
        for line in lines:
            if len(current_chunk + line + '\n') > MAX_MESSAGE_LENGTH:
                if current_chunk:
                    await _send_single_message(current_chunk.strip())
                    current_chunk = line + '\n'
                else:
                    await _send_single_message(line[:MAX_MESSAGE_LENGTH])
            else:
                current_chunk += line + '\n'
        
        if current_chunk:
            await _send_single_message(current_chunk.strip())

async def _send_single_message(message):
    """Send a single message to Telegram"""
    url = f"https://api.telegram.org/bot{TELEGRAM_BOT_TOKEN}/sendMessage"
    payload = {
        'chat_id': TELEGRAM_CHAT_ID,
        'text': message,
        'parse_mode': 'HTML'
    }
    async with aiohttp.ClientSession() as session:
        try:
            async with session.post(url, data=payload) as resp:
                if resp.status != 200:
                    logger.error(f"Failed to send message: {await resp.text()}")
                else:
                    logger.info("Telegram message sent successfully")
        except Exception as e:
            logger.error(f"Telegram error: {e}")

def load_previous_data():
    """Load previous friend data from file"""
    try:
        with open(DATA_FILE, 'r') as f:
            return json.load(f)
    except:
        return {}

def save_data(data):
    """Save friend data to file"""
    with open(DATA_FILE, 'w') as f:
        json.dump(data, f, indent=2)

def is_first_run():
    """Check if this is the first run of the bot"""
    if os.path.exists(INIT_FILE):
        return False
    with open(INIT_FILE, 'w') as f:
        f.write(datetime.now().isoformat())
    return True

async def check_accounts():
    """Main function to check all accounts for friend changes - optimized for speed"""
    start_time = time.time()
    first_run = is_first_run()
    previous_data = load_previous_data()
    current_data = {}
    all_new_friends = []
    
    # Create rate limiter inside the async function
    rate_limiter = FastRateLimiter(MAX_CONCURRENT_REQUESTS, BURST_SIZE, BURST_DELAY)
    
    logger.info(f"Starting fast check for {len(STEAM_ACCOUNTS)} accounts...")
    
    # Optimized session configuration for high throughput
    connector = aiohttp.TCPConnector(
        limit=200,  # High connection pool
        limit_per_host=100,  # High per-host limit
        ttl_dns_cache=300,  # DNS cache
        use_dns_cache=True,
        keepalive_timeout=30,
        enable_cleanup_closed=True
    )
    
    timeout = aiohttp.ClientTimeout(total=15, connect=5)
    
    async with aiohttp.ClientSession(
        connector=connector, 
        timeout=timeout,
        headers={'User-Agent': 'SteamFriendMonitor/1.0'}
    ) as session:
        
        # Create all tasks at once for maximum concurrency
        tasks = [fetch_friend_list(session, steam_id, rate_limiter) for steam_id in STEAM_ACCOUNTS]
        
        # Progress tracking
        completed = 0
        total = len(tasks)
        
        # Process all requests concurrently with progress updates
        for coro in asyncio.as_completed(tasks):
            try:
                steam_id, profile_link, friend_ids = await coro
                completed += 1
                
                # Progress update every 500 accounts
                if completed % 500 == 0 or completed == total:
                    elapsed = time.time() - start_time
                    rate = completed / elapsed
                    eta = (total - completed) / rate if rate > 0 else 0
                    logger.info(f"Progress: {completed}/{total} ({completed/total*100:.1f}%) - {rate:.1f} req/s - ETA: {eta:.1f}s")
                
                if friend_ids is None:
                    continue
                    
                current_data[steam_id] = {
                    'profile_link': profile_link,
                    'friends': friend_ids,
                    'count': len(friend_ids)
                }
                
                # Skip change detection on first run
                if first_run or steam_id not in previous_data:
                    continue
                    
                previous_friends = set(previous_data[steam_id].get('friends', []))
                current_friends = set(friend_ids)
                
                # Check for new friends only
                new_friends = current_friends - previous_friends
                if new_friends:
                    for friend_id in new_friends:
                        friend_profile_link = get_profile_link(friend_id)
                        all_new_friends.append(friend_profile_link)
                        logger.info(f"New friend detected: {friend_id} added to {steam_id}")
                
                # Log removed friends (no telegram notification)
                removed_friends = previous_friends - current_friends
                if removed_friends:
                    for friend_id in removed_friends:
                        logger.debug(f"Friend removed: {friend_id} removed from {steam_id}")
                        
            except Exception as e:
                logger.error(f"Error processing task: {e}")
                completed += 1

    total_time = time.time() - start_time
    successful_accounts = len(current_data)
    avg_rate = successful_accounts / total_time if total_time > 0 else 0
    
    logger.info(f"Completed in {total_time:.2f}s - {avg_rate:.1f} accounts/sec - {successful_accounts}/{len(STEAM_ACCOUNTS)} successful")

    # Send batched notification for all new friends
    logger.info(f"Total new friends collected: {len(all_new_friends)}")
    
    if all_new_friends and not first_run:
        if len(all_new_friends) == 1:
            msg = f"New friend: {all_new_friends[0]}"
        else:
            msg = f"New friends detected ({len(all_new_friends)}):\n\n"
            msg += "\n".join([f" {friend_link}" for friend_link in all_new_friends])
        
        logger.info(f"Sending Telegram notification for {len(all_new_friends)} new friends")
        await send_telegram_message(msg)
    elif all_new_friends and first_run:
        logger.info(f"New friends detected on first run (not sending notification): {len(all_new_friends)}")
    else:
        logger.info("No new friends detected in this cycle")

    # Save current data
    save_data(current_data)

    if first_run:
        total_accounts = len(current_data)
        private_accounts = len(STEAM_ACCOUNTS) - total_accounts
        total_friends = sum(data['count'] for data in current_data.values())
        
        logger.info(f"Steam Friend ID Monitor Setup Complete")
        logger.info(f"Monitoring {total_accounts} accounts")
        logger.info(f"Total friends being tracked: {total_friends}")
        if private_accounts > 0:
            logger.info(f"{private_accounts} accounts are private")
        logger.info("Bot will now notify when specific friends are added with their Steam IDs")
    else:
        logger.info(f"Friend check completed. Successfully processed {successful_accounts} accounts in {total_time:.2f}s")

if __name__ == '__main__':
    asyncio.run(check_accounts())
