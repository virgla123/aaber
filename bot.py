import os
import json
import asyncio
import aiohttp
import logging
from datetime import datetime
import random
import time

# Configuration
TELEGRAM_BOT_TOKEN = os.environ.get('TELEGRAM_BOT_TOKEN', '')
TELEGRAM_CHAT_ID = os.environ.get('TELEGRAM_CHAT_ID', '')
STEAM_API_KEY = os.environ.get('STEAM_API_KEY', '')


STEAM_ACCOUNTS = [

    
    #makima

'76561197997028404','76561198010608505','76561197995348064','76561198027225409','76561198087297348','76561198033115279',
'76561198079929540','76561198101608719','76561198165806979','76561198102885877','76561198214306592','76561198034408524',
'76561198199512505','76561198262845266','76561198212373968','76561198271116426','76561198258289087','76561198016322289',
'76561198283520257','76561198197435149','76561198113445521','76561198393861053','76561198152211922','76561198153784679',
'76561198133868972','76561198206080048','76561198251214896','76561198120343724','76561198170788785','76561198160799267',
'76561198150055795','76561198052391770','76561198121237658','76561198262275145','76561198893140741','76561198799269590',
'76561198241926262','76561198197600818','76561198840655497','76561198859163957','76561198345437523','76561198366194054',
'76561198345041158','76561198374688071','76561198150826247','76561198362919361','76561198254060503','76561198398725087',
'76561198262917719','76561198161999383','76561198988129034','76561198856908589','76561198388427126','76561198584383020',
'76561198969151592','76561198271310542','76561198839498501','76561198813865423','76561198850917515','76561198908525837',
'76561198876158184','76561198881772686','76561198449618981','76561198948231515','76561198815965686','76561198813173189',
'76561198853628000','76561198292932889','76561198958119408','76561198440017791','76561198950299533','76561198851287707',
'76561198798153445','76561198842010196','76561198874615919','76561198408099499','76561198380128863','76561198799710966',
'76561198401232954','76561198811520422','76561198328268217','76561198969038414','76561198866247742','76561198370186657',
'76561198810413486','76561198432916219','76561198835864498','76561198803672914','76561198869496180','76561198875839774',
'76561198877616862','76561198936673187','76561198427808098','76561198880457893','76561198935875224','76561198118222557',
'76561198338092421','76561198206178276','76561197991531660','76561197979012706','76561198004976810','76561197992938057',
'76561198001009416','76561198001623622','76561198385712103','76561198037787857','76561198005698162','76561198018823565',
'76561198046315252','76561198288809723','76561198977533205','76561198249712750','76561198354146673','76561197987030746',
'76561197993482972','76561197997171109','76561197999889528','76561198008535006','76561198010722601','76561198030223034',
'76561198020168829','76561198013750615','76561198062537256','76561198180890550','76561198148875417','76561198049811674',
'76561198860958937','76561198344486567','76561198355563061','76561198381298151','76561198254110089','76561198282255154',
'76561198833792958','76561198310302063','76561198276342567','76561198142355472','76561198108221056','76561198069147103',
'76561197989143464','76561197990318614','76561198003127315','76561198001216683','76561197998424730','76561198007599050',
'76561198032674780','76561198013797596','76561198017675454','76561198035314895','76561198204104416','76561198083854959',
'76561199001194976','76561198800017819','76561198796026462','76561198207755559','76561198274787266','76561198952470129',
'76561198331262300','76561198195145282','76561197977303576','76561197995279803','76561198002716679','76561198001094806',
'76561198080145367','76561198013072288','76561198044529106','76561198012412170','76561198028621775','76561198012273602',
'76561198841341084','76561198053160675','76561198087868387','76561198297244107','76561198157129823','76561198996054101',
'76561198978727834','76561198440480389','76561198964342821','76561198266094488','76561198208723744','76561198126278816',
'76561198102856479','76561197977830137','76561197994902451','76561197996693344','76561198008816742','76561198002295348',
'76561198182823025','76561198001483507','76561198008547848','76561198018347088','76561198055119851','76561198014821181',
'76561198012958988','76561198021881923','76561198110772539','76561198041403773','76561198075873318','76561198179203018',
'76561198272740044','76561198314988589','76561198298356831','76561198888303335','76561199014713266','76561198435771387',
'76561198439776811','76561198015066798','76561198069244425','76561198035677334','76561198025960084','76561198013129575',
'76561198014373302','76561198019240186','76561198040922078','76561197997882074','76561198007508343','76561198010283178',
'76561198042906679','76561198009688189','76561197976169768','76561198137993127','76561198172235266','76561198107180896',
'76561198143233564','76561198102491591','76561198197966341','76561198440627935','76561198305892582','76561198833190282',
'76561198860457381','76561198452841482','76561197984841056','76561198007401372','76561198003513381','76561197994452416',
'76561197996758309','76561198003771666','76561198006591398','76561198001440325','76561198003193868','76561198023935313',
'76561198014548025','76561198083562997','76561198064626913','76561198158128751','76561198125991142','76561198283925983',
'76561198282753291','76561198354778084','76561198309592646','76561198452497847','76561198997699593','76561198986482331',
'76561197976143457','76561198000808066','76561197976765097','76561197973828580','76561197999145108','76561198000215634',
'76561197997876163','76561198006185502','76561198005605996','76561198009739407','76561198039156334','76561198026527136',
'76561198018846681','76561198058202337','76561198054244164','76561198139999761','76561198329452447','76561198291847395',
'76561198118875320','76561198139738159','76561198841588912','76561198345891257','76561198165313936','76561198244239762',
'76561198807733828','76561198806829168','76561198358113730','76561198985804103','76561197988683028','76561198001338332',
'76561198006080645','76561197993163677','76561198011543621','76561198006653936','76561197998415100','76561197998010202',
'76561198354146777','76561198020643402','76561198016755309','76561198023342404','76561198031482020','76561198021537356',
'76561198278739274','76561198058297940','76561198063200569','76561198098171375','76561198396035961','76561198289868523',
'76561198205723117','76561198307626121','76561198279562938','76561198341323801','76561198268930537','76561199008273572',
'76561198392405938','76561198350735066','76561198196236185','76561197983490323','76561198006892691','76561198007401901',
'76561198021312215','76561197995296315','76561198009736254','76561198010992945','76561198003016895','76561198009350950',
'76561198005006485','76561198026201877','76561198024737693','76561198058127837','76561198018791091','76561198017755497',
'76561198087627753','76561198301232825','76561198076440577','76561198079340269','76561198155545898','76561198476282868',
'76561198412334125','76561198174386002','76561198299846562','76561198312129676','76561198873937370','76561198826263451',
'76561198802982064','76561198871249356','76561199087290783','76561198921071018','76561199706257078','76561198133025528',
'76561198001238549','76561198010379443','76561197995697804','76561197999906512','76561197997260651','76561197992321055',
'76561198016731098','76561198050191376','76561198022612703','76561198160970464','76561198013328012','76561198017652475',
'76561198277566687','76561198154056494','76561198064250315','76561198205471745','76561198166038448','76561198199794545',
'76561198349157302','76561198370818362','76561198323570955','76561198285148413','76561198963471953','76561198855606954',
'76561198996856821','76561197999496637','76561197995598353','76561197991716825','76561198004203344','76561197999109192',
'76561197997463387','76561198000835839','76561198012256029','76561198038171602','76561198012074374','76561198019907370',
'76561198023687343','76561198016036860','76561198059346396','76561198160685695','76561198088003137','76561198062137994',
'76561198082434530','76561198056703060','76561198074663440','76561198053526594','76561198160826143','76561198328549880',
'76561198275314093','76561198829992238','76561198312533329','76561198301903862','76561198872463234','76561199055796010',
'76561198295659994','76561197975922022','76561197997376995','76561197992210307','76561197997054855','76561197990930931',
'76561198001025934','76561198011053033','76561197994089294','76561198004386971','76561198014674021','76561198012759581',
'76561198135079894','76561198013763475','76561198058506481','76561198019029139','76561198030970023','76561198022757349',
'76561198107203552','76561198969741770','76561198223339116','76561198976869190','76561198210167351','76561198397008196',
'76561198280976015','76561198834635037','76561198974669610','76561198982868209','76561198009518605','76561198018546991',
'76561198002095277','76561197992371935','76561198007392255','76561198005136674','76561198010288732','76561198003970044',
'76561198006728098','76561197997444562','76561198001761621','76561198016293739','76561198016813096','76561198024598267',
'76561198076222197','76561198049205148','76561198091040702','76561198154849054','76561198181700707','76561198171021970',
'76561198158288736','76561198097237856','76561198137327839','76561198119809267','76561198355872032','76561198252973231',
'76561198354016939','76561198339205514','76561198820099428','76561198799376111','76561198977201499','76561199712334841',
'76561198011066116','76561197996779428','76561198009482058','76561197999088657','76561198001462762','76561197999667321',
'76561198000525041','76561197998053358','76561197999067593','76561198013310929','76561198026501823','76561198019339709',
'76561198025123215','76561198061053035','76561198014043535','76561198066745842','76561198098051442','76561198067052666',
'76561198135715780','76561198338709689','76561198313284270','76561198101353145','76561198264775310','76561198172747945',
'76561198311780119','76561198861138359','76561198295705578','76561198239965358','76561198433575375','76561199032065334',
'76561199014135442','76561199663438222','76561197993541812','76561198004449269','76561198010822863','76561197997928659',
'76561197996934676','76561198003970014','76561198004577334','76561198023859601','76561198031038673','76561198014984981',
'76561198013109173','76561198018953784','76561198024551347','76561198029872969','76561198267633619','76561198011892746',
'76561198280007064','76561198118585638','76561198125151451','76561198138887634','76561198315677603','76561198296099617',
'76561198344235496','76561198358908847','76561198347039034','76561198338904054','76561198341285367','76561198866562404',
'76561199055332790','76561197979865780','76561197988231137','76561198002329336','76561198005509578','76561197995937526',
'76561198007325538','76561197999809124','76561197997124419','76561198022007117','76561198031321820','76561198017236129',
'76561198230481784','76561198077476780','76561198064728319','76561198093078260','76561198295710998','76561198299780884',
'76561198122916953','76561198353046056','76561198337232094','76561198358422386','76561198330899652','76561198964188774',
'76561198873273729','76561198799573029','76561199008986957','76561199068281544','76561197971471010','76561197983805563',
'76561198059390379','76561197979939955','76561197984075943','76561197989138679','76561198007823002','76561197999093886',
'76561197998222518','76561198115245195','76561198004355556','76561197996681021','76561198026230638','76561198017405722',
'76561198013153645','76561198012538044','76561198305115475','76561198048758742','76561198024316244','76561198079279730',
'76561198078194593','76561198107914588','76561198368483759','76561198198648317','76561198453611563','76561198446475166',
'76561198440137898','76561198153070473','76561198000206338','76561198019329187','76561197994657617','76561197992459733',
'76561198009885112','76561197997841778','76561198003644345','76561198011676000','76561198018822155','76561198025818281',
'76561198014169429','76561198074953302','76561198018087635','76561198090101448','76561198249982956','76561198074935597',
'76561198089979040','76561198065059757','76561198136376438','76561198115720925','76561198202208842','76561198045142997',
'76561198149662889','76561198924191408','76561198361685679','76561198843899029','76561198330881718','76561198865867873',
'76561197988627170','76561197986085747','76561197976451953','76561197998660814','76561198003315116','76561198005875521',
'76561198002049557','76561197994098764','76561198009252567','76561197991216273','76561198000738752','76561198025001738',
'76561198023880384','76561198026579040','76561198024426862','76561198047827595','76561198092493378','76561198078790393',
'76561198070322927','76561198050652785','76561198185713274','76561198254884561','76561198149769977','76561198351572790',
'76561198395186246','76561198358122530','76561198293474232','76561198962811564','76561199006029315','76561198913214349',
'76561198973696611','76561198147124934','76561198139004478','76561197975417534','76561197998635763','76561198001297003',
'76561197996799371','76561197992745906','76561198013521990','76561198024322850','76561198017866433','76561198014496436',
'76561198012477930','76561198015267377','76561198017208932','76561198091385880','76561198072182232','76561198044397949',
'76561198082908837','76561198053443649','76561198135554883','76561198125857420','76561198204240060','76561198347315971',
'76561198358941738','76561198833511986','76561198263553211','76561198255548271','76561198421250478','76561198833892662',
'76561198442013365','76561198984968098','76561197978758213','76561197996250503','76561197991067022','76561198000847590',
'76561197999755934','76561198012506867','76561198012241496','76561198123646011','76561198295716149','76561198022857768',
'76561198055388890','76561198025623524','76561198021080299','76561198012606479','76561198066488714','76561198047118731',
'76561198091497786','76561198056413923','76561198080415161','76561198157989677','76561198095892699','76561198204970644',
'76561198105878251','76561198127899308','76561198274326392','76561198869709290','76561198821783923','76561198959972925',
'76561198874748433',


    #WFSSU

    '76561199160280268','76561198044744745','76561199160166044','76561199155035863','76561199155148060','76561199155184931',
'76561199155556156','76561199066383176','76561199128909333','76561199129992278','76561199132569360','76561199132754393',
'76561199154979006','76561199155023347','76561199155105948','76561199155113797','76561199155213017','76561199155389485',
'76561199155740702','76561199124187038','76561199155243292','76561199155406330','76561199114696821','76561199119571128',
'76561199119669926','76561199129148104','76561199155322198','76561199123701374','76561199129629607','76561199155139591',
'76561199155202283','76561199155693099','76561199114948308','76561199128472230','76561199130038164','76561199132391442',
'76561199155368237','76561199119769440','76561199129097715','76561199119579659','76561199129238342','76561199155098050',
'76561199155306894','76561199155021920','76561199155317709','76561199155325626','76561199155513525','76561198089875455',
'76561198038158719','76561199115036745','76561199129892046','76561198367756505','76561199128391966','76561199137774707',
'76561199155509874','76561199114745427','76561199129186857','76561199130021872','76561199147901803','76561199155256699',
'76561199155456344','76561199129189489','76561199129856134','76561199129859884','76561199119745222','76561199134730746',
'76561199147915129','76561199154886544','76561199155178606','76561199114875178','76561199123808779','76561199124085951',
'76561199129734144','76561199154889282','76561199155152610','76561199155501050','76561199129332502','76561199155189137',
'76561199155310831','76561199123565754','76561199129394125','76561199129956547','76561199154709711','76561199155005463',
'76561199114906884','76561199124165492','76561199129166763','76561199130224131','76561199155261874','76561199155263914',
'76561199119788638','76561199123813645','76561199155375889','76561199114802253','76561199129859116','76561199129913111',
'76561199155383146','76561199134133369','76561199137216769','76561199154877910','76561199154892841','76561199155173874',
'76561199155347719','76561199161433727','76561199155279133','76561199119426466','76561199119458102','76561199154979504',
'76561199114926232','76561199129115539','76561199130113945','76561199135962028','76561199155074629','76561199155119100',
'76561199155225184','76561199129722791','76561199155077986','76561199155207084','76561199119418017','76561199119618650',
'76561199123627757','76561199154766820','76561199155189412','76561199115267096','76561199129574157','76561199130243853',
'76561199132928637','76561199119327713','76561199119411571','76561199123949508','76561199129734156','76561199129805309',
'76561199154839863','76561199155004350','76561199155234255','76561199129289132','76561199129611198','76561199129733460',
'76561199129751644','76561199119446093','76561199129826914','76561199154989041','76561199155166712','76561199155424554',
'76561199155432090','76561199068919074','76561199122709303','76561199123544719','76561199129170379','76561199129823751',
'76561199149924335','76561199114748234','76561199123750429','76561199155894456','76561199109830599','76561199129052098',
'76561199155005740','76561199114674897','76561199114909993','76561199123506078','76561199123569541','76561199129890506',
'76561199139517595','76561199154999854','76561199155164943','76561199155253393','76561199155267680','76561199155271415',
'76561199119489479','76561199154937849','76561199155221350','76561199129295787','76561199154930988','76561199155033338',
'76561199155118588','76561199155572442','76561199154876927','76561199155034217','76561199155152944','76561199155276049',
'76561199155295662','76561199155479344','76561199119731065','76561199155208525','76561199155341378','76561199129443851',
'76561199154828571','76561199119599247','76561199128430377','76561199129761956','76561199154849515','76561199154969131',
'76561199155039965','76561199155097968','76561199155118784','76561199155186655','76561199129254679','76561199129962928',
'76561199155243745','76561199129847023','76561199155067204','76561199129455209','76561199154870316','76561199155091624',
'76561199155418954','76561198099106317','76561199149282524','76561199155132578','76561199155193031','76561199155274723',
'76561199155701667','76561199114744680','76561199119580849','76561199128952160','76561199129591267','76561199119455034',
'76561199123624709','76561199129614708','76561199135802578','76561199154998211','76561199155096273','76561199156908573',
'76561199114815817','76561199119521982','76561199129601155','76561199154936568','76561199154937268','76561199155160492',
'76561199155248462','76561199119299122','76561199123733538','76561199155067615','76561199119423197','76561199119689681',
'76561199114623078','76561199114633090','76561199114880642','76561199129940125','76561199154536515','76561199155059905',
'76561199155155012','76561199155245794','76561199114661715','76561199114662560','76561199129784699','76561199129828734',
'76561199154931565','76561199155174517','76561199119416994','76561199129675001','76561199119262367','76561199119505664',
'76561199129458885','76561199154997425','76561199155083010','76561199155534269','76561199159946478','76561199155089093',
'76561199155171839','76561199155213684','76561199155272759','76561199129198030','76561199129454128','76561198121658292',
'76561199114910501','76561199119326581','76561199119628836','76561199129655445','76561199144019824','76561199155060179',
'76561199155097395','76561199155191785','76561199070416703','76561199119585844','76561199129592853','76561199129857631',
'76561199155333236','76561199155440853','76561199158936575','76561199123627443','76561199129090252','76561199154975371',
'76561199069305942','76561199114593509','76561199114958105','76561199119531026','76561199129140199','76561199155297008',
'76561199155455081','76561199114868551','76561199119510732','76561199131654913','76561199155152627','76561199155252145',
'76561199155290415','76561199114758555','76561199119390213','76561199120641486','76561199130021742','76561199154764574',
'76561199155017837','76561199155150226','76561199155232936','76561199114691895','76561199115096190','76561199123835166',
'76561199149718648','76561199161196225','76561199129226998','76561199129429306','76561199129697917','76561199129915749',
'76561199136001639','76561199154848425','76561199154955995','76561199154960871','76561199119430825','76561199119756256',
'76561199128007297','76561199155407517','76561199119401835','76561199129105734','76561199129428623','76561199129488583',
'76561199133084814','76561199154931335','76561199123715577','76561199127470541','76561199131789053','76561199155074977',
'76561199160889667','76561199119444834','76561199119563213','76561199129743262','76561199129832263','76561199129944162',
'76561199154930041','76561199154949558','76561199155310614','76561199123865918','76561199155199964','76561199155338299',
'76561199114700298','76561199119667923','76561199123978228','76561199128573275','76561199154748856','76561199159317490',
'76561199154995591','76561199155221286','76561199155232073','76561199155402552','76561199129163971','76561199138121420',
'76561199155071964','76561199155072303','76561199155221387','76561199052954438','76561198099365589','76561198220888628',
'76561199225931593','76561198853255782','76561198100284498','76561198825916568','76561198050456150','76561198057734574',
'76561198380577487','76561198061606637','76561198316564803','76561198838172708','76561198803222761','76561198072397747',
'76561199155265753','76561199155267253','76561199155340452','76561199155399443','76561199119391290','76561199119479646',
'76561199129939791','76561199154888517','76561199155162791','76561199114834304','76561199114839710','76561199119483836',
'76561199129027261','76561199129641767','76561199129620578','76561199129813295','76561199154707114','76561199114676221',
'76561199119652240','76561199154739588','76561199155048544','76561199155152644','76561199114769072',

    #touhou

    '76561199439232924','76561199438571951','76561199439709202','76561199443254879','76561199437315148','76561199443682764',
'76561199442806079','76561199370442120','76561199376259976','76561199442992514','76561199422866221','76561199434845161',
'76561199371384511','76561199444007754','76561199376333122','76561199385174708','76561199376231456','76561199436039640',
'76561199567429048','76561199435562102','76561199376177541','76561199376077570','76561199376204563','76561199443514777',
'76561199393175860','76561199404971171','76561199375916779','76561199440524847','76561199233518558','76561199376077570',
'76561199441897041','76561199443682764','76561199438374094','76561199439709202','76561199437315148','76561199376204563',
'76561199443254879','76561199438571951','76561199439232924','76561199442806079','76561199376259976','76561199370442120',
'76561199434845161','76561199424275491','76561199434842936','76561199441605843','76561199404790155','76561199405228371',
'76561199416592488','76561199405082116','76561199442022128','76561199372920303','76561199434855530','76561199435186266',
'76561199394717896','76561199405116705','76561199393770489','76561199434842936','76561199404536478','76561199375916779',
'76561199440524847','76561199233518558','76561199446818307','76561199393175860','76561199404971171','76561199214478296',
'76561199442600407','76561199440800308','76561199285626957','76561199439386897','76561199395286530','76561199405228371',
'76561199404781649','76561199392189555','76561199425424436','76561199404710863','76561199442368171','76561199371741399',
'76561199443160128','76561199330746345','76561199423050694','76561199405295532','76561199370281123','76561199268156938',
'76561199405067338','76561199404647002','76561199439990839','76561199405090881','76561199132573781','76561199441599692',
'76561199443562228','76561199405078917','76561199176050121','76561199435031474','76561199440733051','76561199441824491',
'76561199443711151','76561199405317257','76561199439386897','76561199440800308','76561199285626957','76561199439866130',
'76561199440800308','76561199285626957','76561199440667328','76561199395286530','76561199442176292','76561199256508848',
'76561199406869720','76561199404959682','76561199439386897','76561199442600407','76561199436328913','76561199405158192',
'76561199394043947','76561199229042013','76561199435561738','76561199352707593','76561199405029173','76561199405003949',
'76561199439150415','76561199405003005','76561199439101365','76561199442229051','76561199442058653','76561199267804147',
'76561199443619131','76561199024471670','76561199439874070','76561199442454433','76561199441916310','76561199267660180',
'76561199442276849','76561199441944808','76561199441924956','76561199404722500','76561199267580118','76561199442469381',
'76561199439514111','76561199404627167','76561199392002707','76561199405078344','76561199435939166','76561199443061489',
'76561199441560910','76561199405379847','76561199437368407','76561199441647217','76561199404734276','76561199267660180',
'76561199442276849','76561199416578239','76561199441924956','76561199404722500','76561199439641359','76561199442622127',
'76561199441882546','76561199443230379','76561199442189206','76561199439150415','76561199405003005','76561199439101365',
'76561199441647217','76561199416068815','76561199440642037','76561199405258465','76561199404734276','76561199440733502',
'76561199443022777','76561199442915059','76561199405379847','76561199442052654','76561199443496290','76561199416578239',
'76561199441910454','76561199405303017','76561199443359793','76561199404798621','76561199388678529','76561199404890519',
'76561199383932354','76561199405020872','76561199285660683','76561199438856481','76561199176050121','76561199438856481',
'76561199441647217','76561199404734276','76561199405379847','76561199437368407','76561199422696446','76561199441560910',
'76561199443496290','76561199404966126','76561199404456787','76561199441898476','76561199440940431','76561199405168551',
'76561199404890519','76561199383932354','76561199443120505','76561199443562228','76561199405037720','76561199443679582',
'76561199405020872','76561199404913401','76561199376245336','76561199376148812','76561199466438728','76561199443542896',
'76561199441910454','76561199405303017','76561199388678529','76561199442345550','76561199442176292','76561199256508848',
'76561199285292740','76561199442856183','76561199392002707','76561199441922706','76561199441019732','76561199401086140',
'76561199404871708','76561199441297379','76561199405020872','76561199405082202','76561199405372631','76561199439939031',
'76561199404949511','76561199405158192','76561199442091813','76561199376148812','76561199466438728','76561199443542896',
'76561199285660683','76561199442091813','76561199285989004','76561199439970949','76561199443275790','76561199405294340',
'76561199442157554','76561199442201867','76561199434980308','76561199389653077','76561199439866130','76561199438295824',
'76561199443359793','76561199404798621','76561199439298967','76561199404984050','76561199444793320','76561199441926176',
'76561199439632181','76561199388359614','76561199379316956','76561199443085552','76561199442896865','76561199388984356',
'76561199416597150','76561199443572284','76561199405414458','76561199445888191','76561199441716070','76561199404966126',
'76561199439515208','76561199441659146','76561199440031754','76561199442149719','76561199439310396','76561199404996286',
'76561199441870105','76561199442893249','76561199377039992','76561199440930445','76561199443149716','76561199442289358',
'76561199443395247','76561199437672212','76561199442100806','76561199257344632','76561199442704279','76561199440852405',
'76561199023016686','76561199443015724','76561199375362739','76561199441874758','76561199440593678','76561199442335481',
'76561199405154999','76561199438961902','76561199446417760','76561199441749104','76561199378497514','76561199443424303',
'76561199443047038','76561199377039992','76561199437672212','76561199440930445','76561199441870105','76561199442335481',
'76561199439310396','76561199404996286','76561199439632181','76561199388984356','76561199443572284','76561199443085552',
'76561199442896865','76561199416597150','76561199405414458','76561199445888191','76561199440031754','76561199441659146',
'76561199218567141','76561199438309480','76561199240776268','76561199446099196','76561199380390197','76561199442235793',
'76561199439927308','76561199434835272','76561199405092460','76561199346965630','76561199234120870','76561199444045925',
'76561199416144546','76561199439166777','76561199388159971','76561199441209431','76561199243509316','76561199405132722',
'76561199440869780','76561199404444232','76561199435710668','76561199442800942','76561199443870075','76561199380246133',
'76561199388159971','76561199439166777','76561199405058401','76561199440869780','76561199422826663','76561199405069410',
'76561199442858229','76561199416144546','76561199435710668','76561199442800942','76561199405132722','76561199442227092',
'76561199444045925','76561199439768028','76561199439546013','76561199369345938','76561199442711773','76561199214600669',
'76561199443288735','76561199439860569','76561199404444232','76561199443424303','76561199442247388','76561199442203157',
'76561199441297379','76561199441922706','76561199401086140','76561199253980645','76561199441019732','76561199404945669',
'76561199443121584','76561199405446565','76561199442794653','76561199257082232','76561199443232485','76561199443333777',
'76561199440985525','76561199441155303','76561199439514111','76561199404627167','76561199442527935','76561199439607573',
'76561199445045096','76561199441922706','76561199441019732','76561199443121584','76561199439650571','76561199440668114',
'76561199405327723','76561199376153212','76561199404945669','76561199434853315','76561199240776268','76561199380390197',
'76561199401086140','76561199253980645','76561199405041962','76561199442532398','76561199267807536','76561199442235793',
'76561199213029794','76561199148474466','76561199214590791','76561199440668114','76561199214886401','76561199228973343',
'76561199240729494','76561199267660613','76561199012254922','76561199233888115','76561199240782281','76561199176071487',
'76561199191822734','76561199176514132','76561199192218019','76561199240729494','76561199415236348','76561199213029794',
'76561199214590791','76561199214886401','76561199148474466','76561199438309480','76561199434835272','76561199439760327',
'76561199441428778','76561199446521986','76561199446765074','76561199446526854','76561199446500764','76561199446208319',
'76561199445795416','76561199444789424','76561199445549744','76561199446151978','76561199441804979','76561199441570253',
'76561199447063172','76561199439674404','76561199445619763','76561199446114877','76561199446506822','76561199446449675',
'76561199440562272','76561199445165787','76561199445555124','76561199446602970','76561199436804129','76561199441894564',
'76561199441518293','76561199437531536','76561199439727831','76561199445314210','76561199446275827','76561199444967519',
'76561199445382435','76561199446017527','76561199446416162','76561199443639592','76561199445394247','76561199446174131',
'76561199443950027','76561199446166760','76561199444355745','76561199437654822','76561199439206764','76561199447339695',
'76561199447077130','76561199445165787','76561199445789791','76561199447063172','76561199445555124','76561199444492691',
'76561199436332692','76561199445414514','76561199444521144','76561199445776365','76561199441861018','76561199376834744',
'76561199445304500','76561199442151591','76561199446121311','76561199445510983','76561199439210939','76561199446744030',
'76561199441436867','76561199446099786','76561199443493176','76561199446242836','76561199442167681','76561199445568536',
'76561199437805860','76561199436412951','76561199439615041','76561199445315295','76561199446751464','76561199445942166',
'76561199439288582','76561199446212886','76561199441428778','76561199441785708','76561199439674404','76561199446487302',
'76561199441882944','76561199444326822','76561199446174726','76561199445721978','76561199440562272','76561199445481612',
'76561199441833484','76561199445619763','76561199446114877','76561199446506822','76561199446469652','76561199441894564',
'76561199446449675','76561199446679834','76561199445740780','76561199378791380','76561199369739543','76561199446595694',
'76561199443658219','76561199445462176','76561199445776365','76561199442167681','76561199444969390','76561199445635966',
'76561199447105022','76561199442965739','76561199445792090','76561199446584763','76561199445838719','76561199445510983',
'76561199445529293','76561199442874114','76561199445927166','76561199440358983','76561199446751464','76561199445568536',
'76561199437805860','76561199436412951','76561199439288582','76561199445942166','76561199439615041','76561199446212886',
'76561199436617981','76561199315298137','76561199445410161','76561199446035979','76561199445734740','76561199444648225',
'76561199446860867','76561199446057025','76561199446113410','76561199441916863','76561199446524441','76561199445424244',
'76561199445166637','76561199445312516','76561199446627731','76561199445681666','76561199445626485','76561199445252826',
'76561199441076541','76561199446431511','76561199445315295','76561199442154385','76561199446415788','76561199443876504',
'76561198318533648','76561198984187653','76561199000166125','76561199446503027','76561199447118700','76561199446202231',
'76561199465755680','76561198843256060','76561198991706846','76561199445325395','76561199436407503','76561199445512039',
'76561199266713667','76561199443765323','76561199438109691','76561199443314910','76561199445208970','76561199446227345',
'76561199443242397','76561199446376519','76561199446551319','76561199444165382','76561199446410540','76561199446524541',
'76561199445992780','76561199445864171','76561199445597380','76561199447044617','76561199446435332','76561198414178474',
'76561198808496960','76561198378952217','76561198991098980','76561198991393243','76561198855305321','76561198991832700',
'76561198807179459','76561198396530119','76561199046121017','76561198991839275','76561198447518392','76561199230676890',
'76561199475544227','76561199133418244','76561198991295992','76561198991347585','76561198121592392','76561198098929109',
'76561199474501950','76561198161171164','76561199067710498','76561199093208394','76561199476659190','76561199240034073',
'76561198991114116','76561198991358283','76561198991386268','76561198427144188','76561199245000815','76561199004584880',
'76561199262462726','76561198991199268','76561199351908373','76561199143693666','76561199021581210','76561198124833359',
'76561199042658364','76561199188606389','76561198435353299','76561198353235958','76561198351268289','76561198992348813',
'76561199240034073','76561199021581210','76561198991114116','76561198991358283','76561198991832700','76561198399199812',
'76561199123619968','76561198114096119','76561198378952217','76561198803622354','76561198991472451','76561199351908373',
'76561198991839275','76561199046121017','76561198396530119','76561198382157048','76561198808496960','76561198991393243',
'76561198991098980','76561198807179459','76561198855305321','76561198067332843','76561198991516650','76561199041361081',
'76561199407379368','76561199242922897','76561199225281812','76561198880170733','76561199106128168','76561199123560671',
'76561198991241325','76561198873285494','76561198991471238','76561198991809830','76561199093208394','76561199143693666',
'76561198447518392','76561198357377473','76561199182967919','76561199100490555','76561198024786156','76561198991533698',
'76561199004584880','76561199182545176','76561199188178881','76561199446753450','76561199441875577','76561199445397192',
'76561198991614629','76561198102818581','76561198991527133','76561198991417932','76561198991439150','76561198991253715',
'76561198991902128','76561199259869070','76561198805056748','76561198945063425','76561198990561252','76561198991542054',
'76561198991566707','76561198991530037','76561198991464013','76561198991464691','76561198991673121','76561198991081174',
'76561198991675697','76561198991077037','76561198991579373','76561198991188326','76561199237172673','76561198427144188',
'76561198991550468','76561198829952463','76561198370108322','76561198382950790','76561199197777499','76561198991493331',
'76561198991241171','76561198991839275','76561198991098980','76561198991832700','76561199143693666','76561198807179459',
'76561199351908373','76561198808496960','76561198991393243','76561198855305321','76561199046121017','76561199240034073',
'76561198991451384','76561198298861935','76561198959372284','76561198991203496','76561198991507615','76561199048220160',
'76561199160131939','76561198990962671','76561198991586662','76561199064627746','76561199231794362','76561198991483931',
'76561198102818581','76561199407518771','76561198970542159','76561198991194433','76561198990792333','76561198991550468',
'76561199237172673','76561198991425672','76561198991417932','76561198991614629','76561198991421961','76561199041671908',
'76561198991464013','76561198991081174','76561198255356856','76561198991566707','76561198991542054','76561198945063425',
'76561198991673121','76561198410190615','76561198991514966','76561198991527133','76561199258355572','76561198447518392',
'76561199404939338','76561199439791372','76561199405011027','76561199440673390','76561199404990963','76561198396530119',
'76561199021581210',

    #BUFF

    
   '76561199565951669','76561199566029400','76561199566073146','76561199566123322','76561199566127302','76561199566136804',
'76561199566179899','76561199566206854','76561199566243352','76561199566251042','76561199566268734','76561199566307151',
'76561199566312044','76561199566328582','76561199566350391','76561199566399981','76561199566421451','76561199566439904',
'76561199566441193','76561199566474326','76561199566474769','76561199566481416','76561199566484594','76561199566499171',
'76561199566502199','76561199566502697','76561199566505152','76561199566516909','76561199566519423','76561199566526497',
'76561199566526859','76561199566533579','76561199566535011','76561199566537523','76561199566538975','76561199566553069',
'76561199566581697','76561199566588503','76561199565867473','76561199566592267','76561199566597645','76561199566626471',
'76561199566639848','76561199566642191','76561199566642812','76561199566649528','76561199566653049','76561199566654281',
'76561199566665473','76561199566665954','76561199566670450','76561199566677296','76561199566681683','76561199566683030',
'76561199566686421','76561199566692226','76561199566702715','76561199566703757','76561199566712628','76561199566718603',
'76561199566726615','76561199566730155','76561199566730564','76561199566731027','76561199566733292','76561199566747677',
'76561199566747825','76561199566751416','76561199566754037','76561199566761216','76561199566776590','76561199566779638',
'76561199566781121','76561199566783421','76561199566790465','76561199566790912','76561199566791805','76561199566795475',
'76561199566799785','76561199566800541','76561199566805265','76561199566806832','76561199566810441','76561199566814365',
'76561199566818835','76561199566824492','76561199566834475','76561199566838340','76561199566838587','76561199566840450',
'76561199566842218','76561199566845124','76561199566847383','76561199566850422','76561199566856052','76561199566856632',
'76561199566861622','76561199566868888','76561199566892388','76561199566895998','76561199566901652','76561199566910392',
'76561199566921891','76561199566925161','76561199566931660','76561199566935241','76561199566937275','76561199566939291',
'76561199566944332','76561199566947453','76561199566948212','76561199566954042','76561199566964647','76561199566970299',
'76561199566973116','76561199566973128','76561199566973687','76561199566978088','76561199566978960','76561199566983212',
'76561199567001143','76561199567003769','76561199567004663','76561199567004768','76561199567004814','76561199567009533',
'76561199567010557','76561199567016528','76561199567017053','76561199567022051','76561199567030312','76561199567033621',
'76561199567035675','76561199567041795','76561199567049285','76561199567054513','76561199567058053','76561199567058918',
'76561199567061268','76561199567061551','76561199567063630','76561199567064508','76561199567068180','76561199567072138',
'76561199567078291','76561199567080567','76561199567081200','76561199567081542','76561199567083051','76561199567084637',
'76561199567089980','76561199567093921','76561199567106786','76561199567108686','76561199567111610','76561199567114985',
'76561199567118093','76561199567120399','76561199567121752','76561199567124745','76561199567126582','76561199567128758',
'76561199567130700','76561199567132822','76561199567133865','76561199567139968','76561199567140465','76561199567141960',
'76561199567145814','76561199567147739','76561199567157513','76561199567165312','76561199567170125','76561199567170418',
'76561199567171759','76561199567174664','76561199567178556','76561199567180000','76561199567184188','76561199567185611',
'76561199567186535','76561199567190944','76561199567191794','76561199567193440','76561199567193673','76561199567200186',
'76561199567207965','76561199567218762','76561199567222967','76561199567223871','76561199567225856','76561199567226976',
'76561199567227687','76561199567229552','76561199567229789','76561199567229939','76561199567231266','76561199567235844',
'76561199567247440','76561199567247718','76561199567248010','76561199567248484','76561199567252942','76561199567261403',
'76561199567269005','76561199567274924','76561199567275092','76561199567287005','76561199567287991','76561199567291317',
'76561199567297902','76561199567306998','76561199567311759','76561199567320330','76561199567324552','76561199567325978',
'76561199567327231','76561199567333663','76561199567334077','76561199567344647','76561199567345492','76561199567348555',
'76561199567365143','76561199567367635','76561199567368264','76561199567368928','76561199567369239','76561199567370652',
'76561199567382226','76561199567386665','76561199567387663','76561199567390089','76561199567394352','76561199567397698',
'76561199567398224','76561199567399015','76561199567402001','76561199567403222','76561199567408232','76561199567410134',
'76561199567414871','76561199567428572','76561199567431189','76561199567434475','76561199567438202','76561199567446644',
'76561199567450654','76561199567453623','76561199567459814','76561199567462601','76561199567471873','76561199567475683',
'76561199567484310','76561199567487565','76561199567508978','76561199567515356','76561199567518176','76561199567524120',
'76561199567532279','76561199567534097','76561199567543431','76561199567547576','76561199567547979','76561199567555413',
'76561199567563405','76561199567563577','76561199567564299','76561199567569031','76561199567573726','76561199567576128',
'76561199567578360','76561199567593808','76561199567594869','76561199567597369','76561199567599618','76561199567600722',
'76561199567607281','76561199567608021','76561199567621587','76561199567627023','76561199567629164','76561199567630920',
'76561199567638215','76561199567643811','76561199567650078','76561199567651927','76561199567669186','76561199567669723',
'76561199567670413','76561199567675792','76561199567704394','76561199567722191','76561199567725765','76561199567731524',
'76561199567738486','76561199567748408','76561199567752423','76561199567753829','76561199567756711','76561199567763904',
'76561199567771836','76561199567779349','76561199567779365','76561199567780039','76561199567797567','76561199567799929',
'76561199567803490','76561199567808445','76561199567809575','76561199567817851','76561199567823546','76561199567827135',
'76561199567827706','76561199567828521','76561199567828996','76561199567840032','76561199567842153','76561199567846784',
'76561199567849461','76561199567856179','76561199567861992','76561199567864963','76561199567865394','76561199567900836',
'76561199567910072','76561199567910891','76561199567913177','76561199567913524','76561199567917845','76561199567919822',
'76561199567922918','76561199567923965','76561199567928889','76561199567931415','76561199567935464','76561199567947752',
'76561199567949068','76561199567958844','76561199567965884','76561199567967886','76561199567968959','76561199567970568',
'76561199567972488','76561199567972817','76561199567979294','76561199567983388','76561199567986587','76561199567988714',
'76561199567995045','76561199567997039','76561199567998207','76561199567999613','76561199568002286','76561199568003448',
'76561199568015617','76561199568022414','76561199568025187','76561199568025956','76561199568031045','76561199568038543',
'76561199568039592','76561199568042214','76561199568073458','76561199568073509','76561199568074589','76561199568077169',
'76561199568092423','76561199568099187','76561199568099665','76561199568101388','76561199568101715','76561199568105299',
'76561199568111048','76561199568111625','76561199568113795','76561199568114506','76561199568125058','76561199568138629',
'76561199568147540','76561199568155812','76561199568156249','76561199568160026','76561199568160921','76561199568161993',
'76561199568165039','76561199568167284','76561199568169532','76561199568170827','76561199568184920','76561199568193678',
'76561199568197038','76561199568200378','76561199568206056','76561199568206711','76561199568211021','76561199568211459',
'76561199568225925','76561199568226758','76561199568227099','76561199568229602','76561199568230612','76561199568241398',
'76561199568247626','76561199568248764','76561199568256733','76561199568259944','76561199568263220','76561199568269868',
'76561199568278459','76561199568290249','76561199568291622','76561199568294034','76561199568297705','76561199568301704',
'76561199568309060','76561199568314385','76561199568316139','76561199568352206','76561199568359457','76561199568368157',
'76561199568373308','76561199568386407','76561199568394983','76561199568402424','76561199568404955','76561199568410291',
'76561199568414143','76561199568415423','76561199568418590','76561199568435316','76561199568506571','76561199568532947',
'76561199568537390','76561199568557517','76561199568568590','76561199568569917','76561199568595218','76561199568681128',
'76561199568684371','76561199568715997','76561199568746403','76561199568749663','76561199568789447','76561199568800326',
'76561199568837054','76561199568884479','76561199568886053','76561199568983659','76561199568966824','76561199569260544',
'76561199568975662','76561199568973766','76561199569003668','76561199565856638','76561199566136184','76561199566145839',
'76561199566159196','76561199566225964','76561199566227987','76561199566272300','76561199566273955','76561199566275566',
'76561199566284857','76561199566306201','76561199566323953','76561199566324594','76561199566324951','76561199566328237',
'76561199566335882','76561199566356201','76561199566356232','76561199566371493','76561199566375803','76561199566378826',
'76561199566379140','76561199566386203','76561199566396294','76561199566399896','76561199566405976','76561199566450331',
'76561199566458350','76561199566458731','76561199566471874','76561199566485707','76561199566509852','76561199566510182',
'76561199566515929','76561199566533862','76561199566536866','76561199566537666','76561199566543450','76561199566551940',
'76561199566576142','76561199566582322','76561199566586160','76561199566586221','76561199566591867','76561199566591960',
'76561199566608074','76561199566624146','76561199566628141','76561199566633385','76561199566633861','76561199566637580',
'76561199566652069','76561199566657168','76561199566658103','76561199566669569','76561199566674972','76561199566675553',
'76561199566679292','76561199566682663','76561199566691422','76561199566691547','76561199566694526','76561199566703860',
'76561199566710477','76561199566712496','76561199566720008','76561199566720806','76561199566720943','76561199566722163',
'76561199566722517','76561199566723033','76561199566729165','76561199566731266','76561199566731567','76561199566732604',
'76561199566735488','76561199566736902','76561199566737213','76561199566738062','76561199566742561','76561199566743234',
'76561199566757068','76561199566761165','76561199566762559','76561199566762774','76561199566764167','76561199566776327',
'76561199566782198','76561199566785246','76561199566795561','76561199566799267','76561199566802606','76561199566805846',
'76561199566810014','76561199566816003','76561199566818012','76561199566820904','76561199566822784','76561199566823365',
'76561199566830127','76561199566842153','76561199566842973','76561199566844878','76561199566849538','76561199566856613',
'76561199566857597','76561199566873380','76561199566874121','76561199566880716','76561199566881847','76561199566884968',
'76561199566890974','76561199566909575','76561199566920931','76561199566926215','76561199566926590','76561199566927392',
'76561199566929008','76561199566929232','76561199566930999','76561199566940502','76561199566945192','76561199566966929',
'76561199566978740','76561199566984575','76561199566988350','76561199566992272','76561199566998691','76561199567004585',
'76561199567012071','76561199567014571','76561199567014912','76561199567016286','76561199567017074','76561199567018278',
'76561199567028441','76561199567032940','76561199567037816','76561199567039689','76561199567040234','76561199567044894',
'76561199567048794','76561199567049204','76561199567051929','76561199567055019','76561199567055297','76561199567058414',
'76561199567059901','76561199567060256','76561199567061640','76561199567070555','76561199567071067','76561199567071465',
'76561199567073764','76561199567075812','76561199567080037','76561199567081716','76561199567090378','76561199567090515',
'76561199567096059','76561199567098783','76561199567104534','76561199567107755','76561199567112216','76561199567112592',
'76561199567128174','76561199567135045','76561199567135354','76561199567139018','76561199567140850','76561199567141918',
'76561199567142081','76561199567148011','76561199567148271','76561199567149467','76561199567151009','76561199567152199',
'76561199567156884','76561199567158427','76561199567169045','76561199567170172','76561199567173676','76561199567175816',
'76561199567178928','76561199567183435','76561199567184357','76561199567189333','76561199567202005','76561199567205733',
'76561199567208605','76561199567211466','76561199567212300','76561199567222356','76561199567222806','76561199567226603',
'76561199567228225','76561199567229768','76561199567231135','76561199567233009','76561199567235150','76561199567237076',
'76561199567243263','76561199567245070','76561199567251391','76561199567254069','76561199567256609','76561199567259786',
'76561199567265554','76561199567267638','76561199567269439','76561199567270450','76561199567278180','76561199567283688',
'76561199567285259','76561199567288139','76561199567293708','76561199567304208','76561199567314495','76561199567320724',
'76561199567322421','76561199567323858','76561199567326592','76561199567327072','76561199567330218','76561199567336130',
'76561199567340082','76561199567344177','76561199567346129','76561199567349264','76561199567354585','76561199567358899',
'76561199567361059','76561199567364199','76561199567368531','76561199567374758','76561199567375123','76561199567375557',
'76561199567382818','76561199567383296','76561199567389482','76561199567389532','76561199567393207','76561199567393706',
'76561199567397406','76561199567399556','76561199567402103','76561199567405258','76561199567407611','76561199567408462',
'76561199567414452','76561199567416891','76561199567417179','76561199567420245','76561199567433444','76561199567434247',
'76561199567436792','76561199567438619','76561199567441547','76561199567443108','76561199567449239','76561199567451316',
'76561199567456442','76561199567468957','76561199567474360','76561199567476100','76561199567476500','76561199567477596',
'76561199567478269','76561199567479621','76561199567481706','76561199567483964','76561199567485792','76561199567493133',
'76561199567494128','76561199567496768','76561199567506797','76561199567512026','76561199567513071','76561199567519038',
'76561199567521718','76561199567522992','76561199567523379','76561199567527107','76561199567533301','76561199567536318',
'76561199567537337','76561199567539443','76561199567544059','76561199567556228','76561199567560763','76561199567564399',
'76561199567572189','76561199567574710','76561199567593534','76561199567594909','76561199567598062','76561199567598125',
'76561199567601749','76561199567601990','76561199567604534','76561199567605789','76561199567611392','76561199567618814',
'76561199567619025','76561199567620437','76561199567627390','76561199567627848','76561199567628702','76561199567629645',
'76561199567630467','76561199567634777','76561199567636391','76561199567636626','76561199567640704','76561199567644630',
'76561199567644692','76561199567644714','76561199567647111','76561199567655128','76561199567673614','76561199567675085',
'76561199567675492','76561199567675563','76561199567680664','76561199567683418','76561199567685397','76561199567695133',
'76561199567697984','76561199567701071','76561199567701475','76561199567703394','76561199567706460','76561199567712211',
'76561199567712521','76561199567712985','76561199567713617','76561199567714136','76561199567731993','76561199567733248',
'76561199567734198','76561199567735834','76561199567736275','76561199567741371','76561199567742348','76561199567744825',
'76561199567747029','76561199567749392','76561199567752635','76561199567756146','76561199567756876','76561199567758263',
'76561199567764523','76561199567772880','76561199567777109','76561199567783789','76561199567786315','76561199567788275',
'76561199567790364','76561199567804852','76561199567814770','76561199567818820','76561199567831107','76561199567837066',
'76561199567839199','76561199567839698','76561199567850783','76561199567861230','76561199567864664','76561199567891464',
'76561199567893078','76561199567903741','76561199567906870','76561199567913068','76561199567914551','76561199567918785',
'76561199567919554','76561199567923412','76561199567927156','76561199567929664','76561199567930194','76561199567935815',
'76561199567936349','76561199567939751','76561199567947125','76561199567952677','76561199567959135','76561199567962771',
'76561199567964041','76561199567969763','76561199567972472','76561199567993751','76561199567997046','76561199568008468',
'76561199568014959','76561199568031646','76561199568036699','76561199568039574','76561199568047097','76561199568064824',
'76561199568074007','76561199568076809','76561199568077403','76561199568080186','76561199568094459','76561199568094790',
'76561199568096716','76561199568106792','76561199568130576','76561199568138405','76561199568138781','76561199568142076',
'76561199568143778','76561199568147816','76561199568152443','76561199568153263','76561199568154232','76561199568163152',
'76561199568164866','76561199568168962','76561199568189339','76561199568192097','76561199568203560','76561199568204947',
'76561199568210723','76561199568218520','76561199568220125','76561199568225111','76561199568234802','76561199568237700',
'76561199568240360','76561199568243596','76561199568243690','76561199568252855','76561199568254274','76561199568266193',
'76561199568269656','76561199568270619','76561199568282693','76561199568285287','76561199568300842','76561199568332827',
'76561199568333266','76561199568337413','76561199568359479','76561199568359650','76561199568363259','76561199568365561',
'76561199568366649','76561199568375404','76561199568377239','76561199568383273','76561199568390301','76561199568399652',
'76561199568409548','76561199568438711','76561199568457700','76561199568471025','76561199568471509','76561199568481284',
'76561199568490757','76561199568501411','76561199568508613','76561199568512406','76561199568516452','76561199568518567',
'76561199568530362','76561199568535427','76561199568555059','76561199568580360','76561199568614044','76561199568624494',
'76561199568678764','76561199568758266','76561199568779988','76561199568813623','76561199568815421','76561199568837108',
'76561199568876721','76561199568912518','76561199568989509','76561199569135776','76561199029460108','76561198798898784',

    
    
]


DATA_FILE = 'friend_data.json'
INIT_FILE = '.initialized'

# Optimized rate limiting configuration for speed
MAX_CONCURRENT_REQUESTS = 50  # High concurrency
REQUEST_DELAY = 0.1  # Very short delay between requests
BURST_SIZE = 100  # Allow bursts of requests
BURST_DELAY = 5  # Pause after each burst
MAX_RETRIES = 2  # Limit retries to keep speed up

logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')
logger = logging.getLogger("SteamFriendIDMonitor")

class FastRateLimiter:
    def __init__(self, max_concurrent=50, burst_size=100, burst_delay=5):
        self.semaphore = asyncio.Semaphore(max_concurrent)
        self.burst_size = burst_size
        self.burst_delay = burst_delay
        self.request_count = 0
        self.last_burst_reset = None
        self.loop = None
    
    async def acquire(self):
        if self.loop is None:
            self.loop = asyncio.get_event_loop()
            self.last_burst_reset = self.loop.time()
        
        await self.semaphore.acquire()
        
        # Check if we need to pause after a burst
        self.request_count += 1
        if self.request_count >= self.burst_size:
            current_time = self.loop.time()
            time_since_reset = current_time - self.last_burst_reset
            
            if time_since_reset < self.burst_delay:
                sleep_time = self.burst_delay - time_since_reset
                logger.debug(f"Burst limit reached, sleeping for {sleep_time:.2f}s")
                await asyncio.sleep(sleep_time)
            
            self.request_count = 0
            self.last_burst_reset = self.loop.time()
        
        # Small delay to prevent hammering
        await asyncio.sleep(0.05 + random.uniform(0, 0.05))
    
    def release(self):
        self.semaphore.release()

# Rate limiter will be created inside the main function

def get_profile_link(steam_id):
    """Generate Steam profile link from Steam ID"""
    return f"steamcommunity.com/profiles/{steam_id}"

async def fetch_friend_list(session, steam_id, rate_limiter, retry_count=0):
    """Fetch the complete friend list for a Steam account with optimized rate limiting"""
    url = f"http://api.steampowered.com/ISteamUser/GetFriendList/v0001/?key={STEAM_API_KEY}&steamid={steam_id}&relationship=friend"
    profile_link = get_profile_link(steam_id)
    
    await rate_limiter.acquire()
    try:
        async with session.get(url, timeout=10) as resp:
            if resp.status == 200:
                data = await resp.json()
                friends_data = data.get('friendslist', {}).get('friends', [])
                friend_ids = [friend['steamid'] for friend in friends_data]
                return steam_id, profile_link, friend_ids
            elif resp.status == 403:
                logger.debug(f"{profile_link} is private")
                return steam_id, profile_link, None
            elif resp.status in [429, 420]:
                if retry_count < MAX_RETRIES:
                    # Exponential backoff for rate limits
                    delay = (2 ** retry_count) + random.uniform(0, 1)
                    logger.warning(f"{profile_link}: Rate limited, retrying in {delay:.2f}s")
                    await asyncio.sleep(delay)
                    return await fetch_friend_list(session, steam_id, rate_limiter, retry_count + 1)
                else:
                    logger.error(f"{profile_link}: Max retries exceeded for rate limit")
                    return steam_id, profile_link, None
            else:
                logger.warning(f"{profile_link}: API error {resp.status}")
                return steam_id, profile_link, None
    except asyncio.TimeoutError:
        logger.warning(f"Timeout fetching {profile_link}")
        return steam_id, profile_link, None
    except Exception as e:
        logger.warning(f"Error fetching {profile_link}: {e}")
        return steam_id, profile_link, None
    finally:
        rate_limiter.release()

async def send_telegram_message(message):
    """Send message to Telegram, splitting if too long"""
    MAX_MESSAGE_LENGTH = 4000
    
    if len(message) <= MAX_MESSAGE_LENGTH:
        await _send_single_message(message)
    else:
        lines = message.split('\n')
        current_chunk = ""
        
        for line in lines:
            if len(current_chunk + line + '\n') > MAX_MESSAGE_LENGTH:
                if current_chunk:
                    await _send_single_message(current_chunk.strip())
                    current_chunk = line + '\n'
                else:
                    await _send_single_message(line[:MAX_MESSAGE_LENGTH])
            else:
                current_chunk += line + '\n'
        
        if current_chunk:
            await _send_single_message(current_chunk.strip())

async def _send_single_message(message):
    """Send a single message to Telegram"""
    url = f"https://api.telegram.org/bot{TELEGRAM_BOT_TOKEN}/sendMessage"
    payload = {
        'chat_id': TELEGRAM_CHAT_ID,
        'text': message,
        'parse_mode': 'HTML'
    }
    async with aiohttp.ClientSession() as session:
        try:
            async with session.post(url, data=payload) as resp:
                if resp.status != 200:
                    logger.error(f"Failed to send message: {await resp.text()}")
                else:
                    logger.info("Telegram message sent successfully")
        except Exception as e:
            logger.error(f"Telegram error: {e}")

def load_previous_data():
    """Load previous friend data from file"""
    try:
        with open(DATA_FILE, 'r') as f:
            return json.load(f)
    except:
        return {}

def save_data(data):
    """Save friend data to file"""
    with open(DATA_FILE, 'w') as f:
        json.dump(data, f, indent=2)

def is_first_run():
    """Check if this is the first run of the bot"""
    if os.path.exists(INIT_FILE):
        return False
    with open(INIT_FILE, 'w') as f:
        f.write(datetime.now().isoformat())
    return True

async def check_accounts():
    """Main function to check all accounts for friend changes - optimized for speed"""
    start_time = time.time()
    first_run = is_first_run()
    previous_data = load_previous_data()
    current_data = {}
    all_new_friends = []
    
    # Create rate limiter inside the async function
    rate_limiter = FastRateLimiter(MAX_CONCURRENT_REQUESTS, BURST_SIZE, BURST_DELAY)
    
    logger.info(f"Starting fast check for {len(STEAM_ACCOUNTS)} accounts...")
    
    # Optimized session configuration for high throughput
    connector = aiohttp.TCPConnector(
        limit=200,  # High connection pool
        limit_per_host=100,  # High per-host limit
        ttl_dns_cache=300,  # DNS cache
        use_dns_cache=True,
        keepalive_timeout=30,
        enable_cleanup_closed=True
    )
    
    timeout = aiohttp.ClientTimeout(total=15, connect=5)
    
    async with aiohttp.ClientSession(
        connector=connector, 
        timeout=timeout,
        headers={'User-Agent': 'SteamFriendMonitor/1.0'}
    ) as session:
        
        # Create all tasks at once for maximum concurrency
        tasks = [fetch_friend_list(session, steam_id, rate_limiter) for steam_id in STEAM_ACCOUNTS]
        
        # Progress tracking
        completed = 0
        total = len(tasks)
        
        # Process all requests concurrently with progress updates
        for coro in asyncio.as_completed(tasks):
            try:
                steam_id, profile_link, friend_ids = await coro
                completed += 1
                
                # Progress update every 500 accounts
                if completed % 500 == 0 or completed == total:
                    elapsed = time.time() - start_time
                    rate = completed / elapsed
                    eta = (total - completed) / rate if rate > 0 else 0
                    logger.info(f"Progress: {completed}/{total} ({completed/total*100:.1f}%) - {rate:.1f} req/s - ETA: {eta:.1f}s")
                
                if friend_ids is None:
                    continue
                    
                current_data[steam_id] = {
                    'profile_link': profile_link,
                    'friends': friend_ids,
                    'count': len(friend_ids)
                }
                
                # Skip change detection on first run
                if first_run or steam_id not in previous_data:
                    continue
                    
                previous_friends = set(previous_data[steam_id].get('friends', []))
                current_friends = set(friend_ids)
                
                # Check for new friends only
                new_friends = current_friends - previous_friends
                if new_friends:
                    for friend_id in new_friends:
                        friend_profile_link = get_profile_link(friend_id)
                        all_new_friends.append(friend_profile_link)
                        logger.info(f"New friend detected: {friend_id} added to {steam_id}")
                
                # Log removed friends (no telegram notification)
                removed_friends = previous_friends - current_friends
                if removed_friends:
                    for friend_id in removed_friends:
                        logger.debug(f"Friend removed: {friend_id} removed from {steam_id}")
                        
            except Exception as e:
                logger.error(f"Error processing task: {e}")
                completed += 1

    total_time = time.time() - start_time
    successful_accounts = len(current_data)
    avg_rate = successful_accounts / total_time if total_time > 0 else 0
    
    logger.info(f"Completed in {total_time:.2f}s - {avg_rate:.1f} accounts/sec - {successful_accounts}/{len(STEAM_ACCOUNTS)} successful")

    # Send batched notification for all new friends
    logger.info(f"Total new friends collected: {len(all_new_friends)}")
    
    if all_new_friends and not first_run:
        if len(all_new_friends) == 1:
            msg = f"New friend: {all_new_friends[0]}"
        else:
            msg = f"New friends detected ({len(all_new_friends)}):\n\n"
            msg += "\n".join([f"• {friend_link}" for friend_link in all_new_friends])
        
        logger.info(f"Sending Telegram notification for {len(all_new_friends)} new friends")
        await send_telegram_message(msg)
    elif all_new_friends and first_run:
        logger.info(f"New friends detected on first run (not sending notification): {len(all_new_friends)}")
    else:
        logger.info("No new friends detected in this cycle")

    # Save current data
    save_data(current_data)

    if first_run:
        total_accounts = len(current_data)
        private_accounts = len(STEAM_ACCOUNTS) - total_accounts
        total_friends = sum(data['count'] for data in current_data.values())
        
        logger.info(f"Steam Friend ID Monitor Setup Complete")
        logger.info(f"Monitoring {total_accounts} accounts")
        logger.info(f"Total friends being tracked: {total_friends}")
        if private_accounts > 0:
            logger.info(f"{private_accounts} accounts are private")
        logger.info("Bot will now notify when specific friends are added with their Steam IDs")
    else:
        logger.info(f"Friend check completed. Successfully processed {successful_accounts} accounts in {total_time:.2f}s")

if __name__ == '__main__':
    asyncio.run(check_accounts())
